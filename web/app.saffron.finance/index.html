<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<!--
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
	<meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="Expires" content="0">
    These tags are OK for now, but should be deleted and cache should be removed from markup:
    https://stackoverflow.com/a/41126738
  -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
	<!-- og/twitter meta tags below -->
	<meta property="og:site_name" content="Saffron" />
	<meta property="og:type" content="website" />
	<meta name="title" content="saffron.finance" />
	<meta property="og:title" content="saffron.finance" />
	<meta property="twitter:title" content="saffron.finance" />
	<meta name="twitter:site" content="@saffronfinance_" />
	<meta name="description" content="Saffron is a protocol for tokenizing on-chain assets, including contracts that otherwise impair access to utilized capital. Tokenized ownership of on-chain assets gives liquidity providers greaterâ€¦" />
	<meta property="og:description" content="A standard for tokenizing on-chain collateral" />
	<meta property="twitter:description" content="A standard for tokenizing on-chain collateral" />
	<meta property="og:url" content="https://saffron.finance" />
	<meta property="al:web:url" content="https://saffron.finance" />
	<meta property="og:image" content="https://app.saffron.finance/assets/images/saffron-finance-og.png" />
	<meta name="twitter:image:src" content="https://app.saffron.finance/assets/images/saffron-finance-og.png" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="robots" content="noindex,follow,max-image-preview:large" />
	<title>Saffron Finance</title>
	<!-- Favicon -->
	<link rel="apple-touch-icon" sizes="57x57" href="assets/images/favicons/apple-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="assets/images/favicons/apple-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="assets/images/favicons/apple-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="assets/images/favicons/apple-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="assets/images/favicons/apple-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="assets/images/favicons/apple-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="assets/images/favicons/apple-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="assets/images/favicons/apple-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="assets/images/favicons/apple-icon-180x180.png">
	<link rel="icon" type="image/png" sizes="192x192" href="assets/images/favicons/android-icon-192x192.png">
	<link rel="icon" type="image/png" sizes="32x32" href="assets/images/favicons/favicon-32x32.png">
	<link rel="shortcut icon" type="image/png" sizes="96x96" href="assets/images/favicons/favicon-96x96.png">
	<link rel="icon" type="image/png" sizes="16x16" href="assets/images/favicons/favicon-16x16.png">
	<!-- Start css -->
	<!-- Switchery css -->
	<link href="assets/plugins/switchery/switchery.min.css" rel="stylesheet">
	<!-- Sweet Alert css -->
	<link href="assets/plugins/sweet-alert2/sweetalert2.min.css" rel="stylesheet" type="text/css">
	<!-- Range Slider css -->
	<link href="assets/plugins/ion-rangeSlider/ion.rangeSlider.css" rel="stylesheet" type="text/css">
	<!-- Apex css -->
	<link href="assets/plugins/apexcharts/apexcharts.css" rel="stylesheet">
	<!-- Slick css -->
	<link href="assets/plugins/slick/slick.css" rel="stylesheet">
	<link href="assets/plugins/slick/slick-theme.css" rel="stylesheet">
	<link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
	<link href="assets/css/icons.css" rel="stylesheet" type="text/css">
	<link href="assets/css/flag-icon.min.css" rel="stylesheet" type="text/css">
	<link href="assets/css/style.css" rel="stylesheet" type="text/css">
	<link rel="stylesheet" href="https://use.typekit.net/jrv2xzb.css">
	<!-- End css -->
	<style>
	.hide {
		display: none !important;
	}
	
	.table-logo-right {
		position: absolute;
		right: 0;
		height: 32px;
		opacity: 25%;
	}
	
	.graph-logo-right {
		position: absolute;
		top: 40px;
		right: 16px;
		height: 32px;
		opacity: 25%;
	}
	
	.graph-loading {
		position:absolute;
		left:50%;
		transform:translate(-50%, 0);
	}
	
	.media-saffron-logo {
		height: 50px;
	}
	
	.rounded,
	.btn,
	.card {
		border-radius: .50rem!important;
	}
	
	.dot::after {
		content: " ";
		margin: 0px 3px;
		color: rgb(207, 214, 228);
	}
	
	.h42 {
		height: 42px;
	}
	/* No greater than 900px, no less than 400px */
	
	@media (max-width:1200px) and (min-width:1000px) {
		.topbar .togglebar {
			font-size: 14px;
		}
	}
	
	@media (max-width:999px) {
		.topbar .togglebar .hide999 {
			display: none;
		}
	}
	
	.masthead {
		position: fixed;
		overflow: hidden;
		padding: 2rem;
		z-index: 0;
		top: calc(5% + 20px);
	}
	
	.masthead .masthead-content h1 {
		font-size: 2.75rem;
	}
	
	.masthead .masthead-content p {
		font-size: 1.2rem;
		max-width: 46rem;
	}
	
	.masthead .masthead-content p strong {
		font-weight: 700;
	}
	
	@media (min-width: 500px) {
		.masthead {
			top: 50%;
			transform: translateY(-50%);
			padding: 3rem;
			z-index: 0;
		}
		.masthead .masthead-content h1 {
			font-size: 3.75rem;
		}
	}
	
	@media (min-width: 768px) {
		.masthead {
			min-height: 0;
			padding-bottom: 0;
			position: fixed;
			top: 50%;
			transform: translateY(-50%);
			z-index: 0;
		}
		.masthead .masthead-content {
			padding-left: 0;
			padding-right: 0;
		}
		.masthead .masthead-content h1 {
			font-size: 4.75rem;
		}
		.masthead .masthead-content p {
			font-size: 1.3rem;
		}
	}
	
	@media (min-width: 1100px) {
		.masthead .masthead-content {
			padding-left: 12rem;
		}
	}
	
	.muli {
		font-family: "Muli", sans-serif !important;
		white-space: nowrap;
	}
	
	.muli img {
		width: .75em !important;
		vertical-align: text-bottom !important;
		margin-right: 10px;
	}
	
	.mont {
		font-family: "Montserrat", sans-serif !important;
	}
	
	.btn.mont {
		padding: .5rem 1rem;
		font-size: 1.25rem;
		line-height: 1.5;
		border-radius: .3rem;
	}
	
	.onTop {
		position: relative;
		z-index: 1000;
	}
	
	.midLevel {
		position: fixed;
		z-index: -10;
		top: 0;
		bottom: 0;
		left: 0;
		right: 0;
		height: 100%;
	}
	
	a.btn {
		-webkit-appearance: none;
		-moz-appearance: none;
		appearance: none;
	}
	
	.coming-soon .countdown-block {
		display: inline-block;
		padding: 10px;
	}
	</style>
</head>

<body class="vertical-layout">
	<!-- Start Infobar Setting Sidebar -->
	<div id="infobar-settings-sidebar" class="infobar-settings-sidebar">
		<div class="infobar-settings-sidebar-head d-flex w-100 justify-content-between">
			<h4>Settings</h4><a href="javascript:void(0)" id="infobar-settings-close" class="infobar-settings-close"><span class="iconbar"><i class="ri-close-line menu-hamburger-close"></i></span></a> </div>
		<div class="infobar-settings-sidebar-body">
			<div class="custom-mode-setting">
				<div class="row align-items-center pb-3">
					<div class="col-8">
						<h6 class="mb-0">Popup Notification</h6></div>
					<div class="col-4">
						<input type="checkbox" class="js-switch-setting-first" checked />
					</div>
				</div>
				<div class="row align-items-center pb-3">
					<div class="col-8">
						<h6 class="mb-0">Message Sound</h6></div>
					<div class="col-4">
						<input type="checkbox" class="js-switch-setting-second" checked />
					</div>
				</div>
				<div class="row align-items-center pb-3">
					<div class="col-8">
						<h6 class="mb-0">Generate Report</h6></div>
					<div class="col-4">
						<input type="checkbox" class="js-switch-setting-third" />
					</div>
				</div>
				<div class="row align-items-center pb-3">
					<div class="col-8">
						<h6 class="mb-0">Email Statement</h6></div>
					<div class="col-4">
						<input type="checkbox" class="js-switch-setting-fourth" checked />
					</div>
				</div>
				<div class="row align-items-center pb-3">
					<div class="col-8">
						<h6 class="mb-0">Invoice PDF</h6></div>
					<div class="col-4">
						<input type="checkbox" class="js-switch-setting-fifth" checked />
					</div>
				</div>
				<div class="row align-items-center pb-3">
					<div class="col-8">
						<h6 class="mb-0">Add Users</h6></div>
					<div class="col-4">
						<input type="checkbox" class="js-switch-setting-sixth" />
					</div>
				</div>
				<div class="row align-items-center pb-3">
					<div class="col-8">
						<h6 class="mb-0">Show Sidebar</h6></div>
					<div class="col-4">
						<input type="checkbox" class="js-switch-setting-seventh" checked />
					</div>
				</div>
				<div class="row align-items-center">
					<div class="col-8">
						<h6 class="mb-0">Sticky Topbar</h6></div>
					<div class="col-4">
						<input type="checkbox" class="js-switch-setting-eightth" checked />
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="infobar-settings-sidebar-overlay"></div>
	<!-- End Infobar Setting Sidebar -->
	<!-- Start Containerbar -->
	<div id="containerbar">
		<!-- Start Leftbar -->
		<div class="leftbar">
			<!-- Start Sidebar -->
			<div class="sidebar">
				<!-- Start Logobar -->
				<div class="logobar">
					<a href="#home" data-toggle="tab" class="logo logo-large"><img src="assets/images/saffron.svg" class="img-fluid" alt="logo"></a>
					<a href="#home" data-toggle="tab" class="logo logo-small"><img src="assets/images/saffron.svg" class="img-fluid" alt="logo"></a>
				</div>
				<!-- End Logobar -->
				<!-- Start Navigationbar -->
				<div class="navigationbar">
					<ul class="vertical-menu">
						<li>
							<a href="#dashboard" data-toggle="tab"> <i class="ri-dashboard-fill"></i>
								<br><span>Dashboard</span> </a>
						</li>
						<li>
							<a href="#liquidity" data-toggle="tab"> <i class="ri-contrast-drop-2-fill"></i>
								<br><span>Liquidity<br>Pools</span> </a>
						</li>
						<li>
							<a href="#redeem" data-toggle="tab"> <i class="ri-star-fill"></i>
								<br><span>Redeem</span> </a>
						</li>
						<!--<li>
                            <a href="#about" data-toggle="tab">
                                <i class="ri-information-fill"></i><br><span>About</span>
                            </a>
                        </li>-->
						<li>
							<a href="#docs" data-toggle="tab"> <i class="ri-file-text-fill"></i>
								<br><span>Docs</span> </a>
						</li>
						<li>
							<a href="#community" data-toggle="tab"> <i class="ri-message-2-fill"></i>
								<br><span>Community</span> </a>
						</li>
					</ul>
				</div>
				<!-- End Navigationbar -->
			</div>
			<!-- End Sidebar -->
		</div>
		<!-- End Leftbar -->
		<!-- Start Rightbar -->
		<div class="rightbar">
			<!-- Start Topbar Mobile -->
			<div class="topbar-mobile">
				<div class="row align-items-center">
					<div class="col-md-12">
						<div class="mobile-logobar">
							<a href="#home" class="mobile-logo"><img src="assets/images/logo.png" class="img-fluid" alt="logo"></a>
						</div>
						<div class="mobile-togglebar">
							<ul class="list-inline mb-0">
								<li class="list-inline-item">
									<div class="topbar-toggle-icon">
										<a class="topbar-toggle-hamburger" href="javascript:void();"> <span class="iconbar">
                                                <i class="ri-more-fill menu-hamburger-horizontal"></i>
                                                <i class="ri-more-2-fill menu-hamburger-vertical"></i>
                                            </span> </a>
									</div>
								</li>
								<li class="list-inline-item">
									<div class="menubar">
										<a class="menu-hamburger" href="javascript:void();"> <span class="iconbar">
                                                <i class="ri-menu-2-line menu-hamburger-collapse"></i>
                                                <i class="ri-close-line menu-hamburger-close"></i>
                                            </span> </a>
									</div>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
			<!-- Start Topbar -->
			<div class="topbar">
				<!-- Start row -->
				<div class="row align-items-center">
					<!-- Start col -->
					<div class="col-md-12 align-self-center">
						<div class="togglebar  align-self-center">
							<ul class="list-inline mb-0 mt-2">
								<li class="list-inline-item dot"> Portfolio: <a href="#redeem" id="topbarPortfolio">-NA-</a> </li>
								<li class="list-inline-item dot hide999"> <a href="#liquidity" class="badge badge-primary" style="font-size: 100%;">Highest APY:  <span  id="topbarHighestAPY">-NA-</span></a> </li>
								<li class="list-inline-item dot hide999"> SFI: <a href="#docs" id="topbarSFI" target="_blank">-NA-</a> </li>
								<li class="list-inline-item dot hide999"> ETH: <a href="https://www.coingecko.com/en/coins/ethereum" id="topbarETH" target="_blank">-NA-</a> </li>
								<li class="list-inline-item hide999"> BTC: <a href="https://www.coingecko.com/en/coins/bitcoin" id="topbarBTC" target="_blank">-NA-</a> </li>
							</ul>
						</div>
						<div class="infobar">
							<ul class="list-inline mb-0">
								<li class="list-inline-item">
									<div class="profilebar"> <span class="h4 m-r-10"><span id="hSfiTokensOwned" class="badge badge-primary"></span></span>
										<button id="btnConnectWallet" class="btn btn-primary" type="button"> <i id="iconConnectWallet" class="mdi mdi-ethereum mr-2"></i> <span id="spanConnectWallet" class="spinner-border spinner-border-sm hide" role="status" aria-hidden="true"></span> Connect Wallet </button>
										<button id="btnConnected" class="btn btn-outline-primary hide" type="button"> <i class="mdi mdi-ethereum mr-2"></i> <span id="spanConnected"></span> </button>
									</div>
								</li>
							</ul>
						</div>
					</div>
					<!-- End col -->
				</div>
				<!-- End row -->
			</div>
			<!-- End Topbar -->
			<div class="tab-content">
				<div class="tab-pane fade position-relative active" id="home">
					<div id="tsparticles" class="midLevel"></div>
					<!-- style1="background-color: rgb(255, 255, 255); background-position: 50% 50%; background-repeat: no-repeat; background-size: cover;" -->
					<div class="masthead">
						<div class="masthead-content py-5 py-md-0">
							<h1 class="mb-3 muli"><img class="mr-3" src="assets/images/saffron.png" alt="saffron">Saffron</h1>
							<p style="line-height: 1.5em" class="mb-5 mont"> Saffron is an asset collateralization platform where liquidity providers have access to dynamic exposure by selecting customized risk and return profiles. </p>
							<div> <a href="#docs" class="btn btn-secondary btn-lg mont mb-2">Learn More</a> <a href="#dashboard" class="btn btn-primary btn-lg mont mb-2">Dashboard</a> </div>
						</div>
					</div>
				</div>
				<div class="tab-pane fade show" id="dashboard">
					<!-- Start Breadcrumbbar -->
					<div class="breadcrumbbar">
						<div class="row align-items-center">
							<div class="col-md-8 col-lg-8">
								<h4 class="page-title">Dashboard</h4>
								<div class="breadcrumb-list">
									<ol class="breadcrumb">
										<li class="breadcrumb-item"><a href="#home">Home</a></li>
										<li class="breadcrumb-item"><a href="#dashboard">Dashboard</a></li>
									</ol>
								</div>
							</div>
							<div class="col-md-4 col-lg-4">
								<div class="widgetbar">
									<button class="btn btn-primary refresh"><i class="fa fa-refresh fa-fw mr-2"></i>Refresh</button>
								</div>
							</div>
						</div>
					</div>
					<!-- End Breadcrumbbar -->
					<!-- Start Contentbar -->
					<div class="contentbar">
						<!-- Start row -->
						<div class="row pt-0 mb-0">
							<div class="col-xl-12 h5">Overview</div>
							<!-- Start col -->
							<div class="col-lg-12 col-xl-4">
								<div class="card m-b-10">
									<div class="card-body">
										<div class="row align-items-center no-gutters">
											<div class="col-8">
												<p class="font-15">Portfolio Value</p>
												<h4 id="hPortfolioValue" class="card-title mb-0">-NA-</h4> </div>
											<div class="col-4 text-right"> <span class="iconbar iconbar-md bg-primary text-white rounded"><i class="ri-money-dollar-circle-line align-unset"></i></span> </div>
										</div>
									</div>
								</div>
							</div>
							<!-- End col -->
							<!-- Start col -->
							<div class="col-lg-12 col-xl-4">
								<div class="card m-b-10">
									<div class="card-body">
										<div class="row align-items-center no-gutters">
											<div class="col-8">
												<p class="font-15">Portfolio Principal</p>
												<h4 id="hPortfolioPrincipalTokens" class="card-title mb-0">-NA-</h4> </div>
											<div class="col-4 text-right"> <span class="iconbar iconbar-md bg-primary text-white rounded"><i class="ri-money-dollar-circle-line align-unset"></i></span> </div>
										</div>
									</div>
								</div>
							</div>
							<!-- End col -->
							<div class="col-lg-12 col-xl-4">
								<div class="card m-b-10">
									<div class="card-body">
										<div class="row align-items-center no-gutters">
											<div class="col-8">
												<p class="font-15">Portfolio Earnings</p>
												<h4 id="hPortfolioEarnings" class="card-title mb-0">-NA-</h4> </div>
											<div class="col-4 text-right"> <span class="iconbar iconbar-md bg-primary text-white rounded"><i class="ri-money-dollar-circle-line align-unset"></i></span> </div>
										</div>
									</div>
								</div>
							</div>
							<!-- End col -->
						</div>
						<!-- End row -->
						<!-- Start row -->
						<div class="row pt-0 mb-0">
							<div class="col-xl-12 h5 mt-1 mb-2">Earnings</div>
							<!-- Start col -->
							<div class="col-lg-12 col-xl-3">
								<div class="card m-b-10">
									<div class="card-body">
										<div class="row align-items-center no-gutters">
											<div class="col-8">
												<p class="font-15">Interest Earned</p>
												<h4 id="hInterestEarned" class="card-title mb-0">-NA-</h4> </div>
											<div class="col-4 text-right"> <span class="iconbar iconbar-md bg-primary text-white rounded"><i class="ri-exchange-dollar-line align-unset"></i></span> </div>
										</div>
									</div>
								</div>
							</div>
							<!-- End col -->
							<!-- Start col -->
							<div class="col-lg-12 col-xl-3">
								<div class="card m-b-10">
									<div class="card-body">
										<div class="row align-items-center no-gutters">
											<div class="col-8">
												<p class="font-15">SFI Earned <span tabindex="-1" class="text-primary" role="button" data-toggle="popover" data-trigger="focus" title="SFI Earned" data-content="SFI is mined by adding liquidity into the S, AA, or A tranches. The AA tranche has the highest SFI return but earns the lowest amount of interest." data-original-title="SFI Earned"><i class="fa fa-info-circle"></i></span> </p>
												<h4 id="hSfiTokensEarned" class="card-title mb-0">-NA-</h4> </div>
											<div class="col-4 text-right"> <span class="iconbar iconbar-md bg-primary text-white rounded"><i class="ri-coin-line align-unset"></i></span> </div>
										</div>
									</div>
								</div>
							</div>
							<!-- End col -->
							<!-- Start col -->
							<div class="col-lg-12 col-xl-6">
								<div class="card m-b-10">
									<div class="card-body"> SFI tokens are the native currency of <a href="#">saffron.finance</a>. SFI tokens are minted and distributed to liquidity providers proportionally at the end of every epoch. SFI tokens must be staked to provide liquidity into the yield-enhancing <a href="#docs">A tranche</a>. </div>
								</div>
							</div>
							<!-- End col -->
						</div>
						<!-- End row -->
						<!-- Start row -->
						<div class="row pt-0 mb-0">
							<div class="col-xl-12 h5 mt-1 mb-2">Estimated Earnings</div>
							<!-- Start col -->
							<div class="col-lg-12 col-xl-3">
								<div class="card m-b-10">
									<div class="card-body">
										<div class="row align-items-center no-gutters">
											<div class="col-8">
												<p class="font-15">Interest Estimated</p>
												<h4 id="hInterestEstimated" class="card-title mb-0">-NA-</h4> </div>
											<div class="col-4 text-right"> <span class="iconbar iconbar-md bg-primary text-white rounded"><i class="ri-exchange-dollar-line align-unset"></i></span> </div>
										</div>
									</div>
								</div>
							</div>
							<!-- End col -->
							<!-- Start col -->
							<div class="col-lg-12 col-xl-3">
								<div class="card m-b-10">
									<div class="card-body">
										<div class="row align-items-center no-gutters">
											<div class="col-8">
												<p class="font-15">SFI Estimated</p>
												<h4 id="hSfiTokensEstimated" class="card-title mb-0">-NA-</h4> </div>
											<div class="col-4 text-right"> <span class="iconbar iconbar-md bg-primary text-white rounded"><i class="ri-coin-line align-unset"></i></span> </div>
										</div>
									</div>
								</div>
							</div>
							<!-- End col -->
							<!-- Start col -->
							<div class="col-lg-12 col-xl-6">
								<div class="card m-b-10">
									<div class="card-body"> Estimates are based on current contract state and previous epoch outcomes but can change as total locked value increases in varying rates over time. </div>
								</div>
							</div>
							<!-- End col -->
						</div>
						<!-- End row -->
						<div class="row pt-0 mb-0">
							<div class="col-xl-12 h5 mt-1 mb-2">saffron.finance</div>
							<!-- Start col -->
							<div class="col-lg-12 col-xl-12">
								<div class="card m-b-30">
									<div class="card-header">
										<div class="row align-items-center">
											<div class="col-6 col-lg-9">
												<h5 class="card-title mb-0">Total Liquidity (USD)</h5> 
											</div>
											<div class="col-6 col-lg-3">
												<select id="dashboardGraphDays" class="form-control font-12">
													<option value="1" selected>Last Day</option>
													<option value="7">Last Week</option>
													<option value="30">Last Month</option>
													<option value="365">Last Year</option>
												</select> 
												<img src="assets/images/saffron.svg" alt="logo" class="graph-logo-right">
											</div>
										</div>
										<h2 id="hTotalLiquidity">-NA-</h2> 
									</div>
									<div class="card-body p-0">
										<h3 id="historyLoading" class="text-primary text-nowrap graph-loading hide"><i class="fa fa-refresh fa-spin fa-fw"></i> Loading history...</h3>
										<div id="dashboard-apex-area-chart"></div>
									</div>
								</div>
							</div>
							<!-- End col -->
						</div>
						<!-- End row -->
						<!-- Start row -->
						<div class="row">
							<!-- Start col -->
							<div class="col-lg-6">
								<div class="card m-b-30">
									<div class="card-header">
										<h5 class="card-title position-relative">Liquidity Pool Explorer<img src="assets/images/saffron.svg" alt="logo"  class="table-logo-right"></h5> </div>
									<div class="card-body">
										<div class="table-responsive">
											<table class="table">
												<thead class="thead-light">
													<tr>
														<th scope="col">Currency</th>
														<th scope="col">Est. Weekly</th>
														<th scope="col">APY</th>
														<th scope="col">SFI Earnings (24hr)</th>
														<th scope="col">Liquidity</th>
													</tr>
												</thead>
												<tbody id="tblDashPoolExplorer">
													<tr>
														<td colspan="5">-NA-</td>
														<!-- 		                                                <th scope="row">DAI</th> -->
														<!-- 		                                                <td>2.05%</td> -->
														<!-- 		                                                <td>60%</td> -->
														<!-- 		                                                <td>43.00</td> -->
														<!-- 		                                                <td>$300,000</td> -->
													</tr>
												</tbody>
											</table>
										</div>
									</div>
								</div>
							</div>
							<!-- End col -->
							<!-- Start col -->
							<div class="col-lg-6">
								<div class="card m-b-30">
									<div class="card-header">
										<h5 class="card-title position-relative">Upcoming Epoch End Date<img src="assets/images/saffron.svg" alt="logo"  class="table-logo-right"></h5> </div>
									<div class="card-body">
										<div class="table-responsive">
											<table class="table">
												<thead class="thead-light">
													<tr>
														<th scope="col">Pool</th>
														<th scope="col">Epoch</th>
														<th scope="col">Total</th>
														<th scope="col">Epoch End Date</th>
														<th scope="col">Time Remaining</th>
													</tr>
												</thead>
												<tbody id="tblDashExpirationDates">
													<tr>
														<td colspan="5">-NA-</td>
														<!-- 		                                                <th scope="row">DAI</th>
		                                                <td>$10,000</td>
		                                                <td>8.50%</td>
		                                                <td>9.13.2020</td>
		                                                <td><button>View ></button> -->
													</tr>
												</tbody>
											</table>
										</div>
									</div>
								</div>
							</div>
							<!-- End col -->
						</div>
						<!-- End row -->
					</div>
					<!-- End Contentbar -->
				</div>
				<div class="tab-pane fade" id="liquidity">
					<!-- Start Breadcrumbbar -->
					<div class="breadcrumbbar">
						<div class="row align-items-center">
							<div class="col-md-8 col-lg-8">
								<h4 class="page-title">Liquidity</h4>
								<div class="breadcrumb-list">
									<ol class="breadcrumb">
										<li class="breadcrumb-item"><a href="#home">Home</a></li>
										<li class="breadcrumb-item"><a href="#liquidity">Liquidity</a></li>
									</ol>
								</div>
							</div>
							<div class="col-md-4 col-lg-4">
								<div class="widgetbar">
									<button class="btn btn-primary refresh"><i class="fa fa-refresh fa-fw mr-2"></i>Refresh</button>
								</div>
							</div>
						</div>
					</div>
					<!-- End Breadcrumbbar -->
					<!-- Start Contentbar -->
					<div class="contentbar">
						<!-- Start row -->
						<div class="row">
							<!-- Start col -->
							<div class="col-md-6 col-lg-4 col-xl-3">
								<div class="card text-center m-b-30">
									<div class="card-body">
										<h5 class="card-title font-18">DAI POOL</h5>
										<p class="card-text"> <img src="assets/images/dai.png" class="h42 mb-1" alt="dai"></p>
										<p>A tranche multiplier: <b id="hDaiAdapterMultiplier">-NA-</b>
											<br>APY: <b id="hDaiAdapterAPY">-NA-</b>
										</p>
										<button id="btnPoolDepositDai" class="btn btn-primary">Deposit DAI</button>
									</div>
								</div>
							</div>
							<!-- End col -->
							<!-- Start col -->
							<div class="col-md-6 col-lg-4 col-xl-3">
								<div class="card text-center m-b-30 disabled" style="opacity:.4">
									<div class="card-body">
										<h5 class="card-title font-18">SFI POOL</h5>
										<p class="card-text"> <img src="assets/images/sfi.png" class="h42 mb-1" alt="sfi"></p>
										<p>A tranche multiplier: <b id="hSfiAdapterMultiplier">-NA-</b>
											<br>APY: <b id="hSfiAdapterAPY">-NA-</b>
										</p>
										<button id="btnPoolDepositSfi" disabled class="btn">Coming Soon</button>
									</div>
								</div>
							</div>
							<!-- End col -->
							<!-- Start col -->
							<div class="col-md-6 col-lg-4 col-xl-3">
								<div class="card text-center m-b-30 disabled" style="opacity:.4">
									<div class="card-body">
										<h5 class="card-title font-18">USDT POOL</h5>
										<p class="card-text"> <img src="assets/images/usdt.png" class="h42 mb-1" alt="usdt"></p>
										<p>A tranche multiplier: <b id="hUsdtAdapterMultiplier">-NA-</b>
											<br>APY: <b id="hUsdtAdapterAPY">-NA-</b>
										</p>
										<button id="btnPoolDepositUsdt" disabled class="btn">Coming Soon</button>
									</div>
								</div>
							</div>
							<!-- End col -->
						</div>
						<!-- End row -->
					</div>
					<!-- End Contentbar -->
				</div>
				<div class="tab-pane fade" id="redeem">
					<!-- Start Breadcrumbbar -->
					<div class="breadcrumbbar">
						<div class="row align-items-center">
							<div class="col-md-8 col-lg-8">
								<h4 class="page-title">Redeem</h4>
								<div class="breadcrumb-list">
									<ol class="breadcrumb">
										<li class="breadcrumb-item"><a href="#home">Home</a></li>
										<li class="breadcrumb-item"><a href="#redeem">Redeem</a></li>
									</ol>
								</div>
							</div>
							<div class="col-md-4 col-lg-4">
								<div class="widgetbar">
									<button class="btn btn-primary refresh"><i class="fa fa-refresh fa-fw mr-2"></i>Refresh</button>
								</div>
							</div>
						</div>
					</div>
					<!-- End Breadcrumbbar -->
					<!-- Start Contentbar -->
					<div class="contentbar">
						<!-- Start row -->
						<div class="row">
							<!-- Start col -->
							<div class="col-md-12">
								<div class="card m-b-30">
									<div class="card-body">
										<!-- Start row -->
										<div class="row">
											<!-- Start col -->
											<div class="col-lg-12 col-xl-3 m-t-10">
												<div class="media mb-4"> <span class="iconbar iconbar-md bg-primary text-white rounded align-self-center mr-3"><i class="ri-calendar-check-line align-unset"></i></span>
													<div class="media-body">
														<h5 class="mt-0 mb-1 font-16">Next Epoch Start</h5>
														<p id="redeemTabNextRemovalWindow" class="mb-0">-NA-</p>
													</div>
												</div>
												<p><span id="redeemTabNextRemovalText">Epoch Ending In:</span> <span id="redeemTabNextRemovalTime" class="float-right">-NA-</span></p>
												<div class="progress">
													<div id="redeemTabProgressBar" class="progress-bar progress-bar-striped progress-bar-animated bg-primary" role="progressbar" style="width: 0%;" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
												</div>
											</div>
											<!-- End col -->
											<!-- Start col -->
											<div class="col-lg-12 col-xl-9">
												<!-- Start row -->
												<div class="row m-t-10">
													<!-- Start col -->
													<div class="col-lg-12 col-xl-4">
														<div class="card h-100">
															<div class="card-body">
																<div class="row align-items-start no-gutters">
																	<div class="col-8">
																		<p class="font-15">Principal Tokens</p>
																		<h4 id="hPortfolioPrincipalTokensAll" class="card-title mb-0 text-nowrap">-NA-</h4> </div>
																	<div class="col-4 text-right"> <span class="iconbar iconbar-md bg-primary text-white rounded"><i class="ri-money-dollar-circle-line align-unset"></i></span> </div>
																</div>
															</div>
														</div>
													</div>
													<!-- End col -->
													<!-- Start col -->
													<div class="col-lg-12 col-xl-4">
														<div class="card h-100">
															<div class="card-body">
																<div class="row align-items-start no-gutters">
																	<div class="col-8">
																		<p class="font-15">Interest Earned</p>
																		<h4 id="hInterestEarnedAll" class="card-title mb-0 text-nowrap">-NA-</h4> </div>
																	<div class="col-4 text-right"> <span class="iconbar iconbar-md bg-primary text-white rounded"><i class="ri-moon-clear-line align-unset"></i></span> </div>
																</div>
															</div>
														</div>
													</div>
													<!-- End col -->
													<!-- Start col -->
													<div class="col-lg-12 col-xl-4">
														<div class="card h-100">
															<div class="card-body">
																<div class="row align-items-start no-gutters">
																	<div class="col-8">
																		<p class="font-15">SFI Earned <span tabindex="-1" class="text-primary" role="button" data-toggle="popover" data-trigger="focus" title="" data-content="SFI is mined by adding liquidity into the S, AA, or A tranches. The AA tranche has the highest SFI return but earns the lowest amount of interest." data-original-title="SFI Earned"><i class="fa fa-info-circle"></i></span> </p>
																		<h4 id="hSfiTokensEarnedAll" class="card-title mb-0 text-nowrap">-NA-</h4> </div>
																	<div class="col-4 text-right"> <span class="iconbar iconbar-md bg-primary text-white rounded"><i class="ri-coin-line align-unset"></i></span> </div>
																</div>
															</div>
														</div>
													</div>
													<!-- End col -->
												</div>
												<!-- End row -->
											</div>
											<!-- End col -->
										</div>
										<!-- End row -->
									</div>
								</div>
							</div>
							<!-- End col -->
						</div>
						<!-- End row -->
						<!-- Start row -->
						<div class="row">
							<!-- Start col -->
							<div class="col-md-12">
								<div class="card m-b-30">
									<div class="card-body">
										<!-- Start row -->
										<div class="row">
											<!-- Start col -->
											<div class="col-lg-12 col-xl-1 text-center">
												<h5 class="card-title font-18">DAI POOL</h5>
												<p class="card-text"> <img src="assets/images/dai.png" class="h42" alt="DAI">
													<br> </p>
												<button id="btnPoolRedeemDai" class="btn btn-primary">Redeem</button>
											</div>
											<!-- End col -->
											<!-- Start col -->
											<div class="col-lg-12 col-xl-3 text-left">
												<div class="card">
													<div class="card-body p-3">
														<div class="media pb-0">
															<img src="assets/images/compound.png" class="h42 mr-3" alt="COMPOUND">
															<div class="media-body">
																<h5 class="card-title font-18">Adapter</h5>
																	<p class="mb-0">
																		S Tranche APY: <b id="hDaiAdapterSHighestAPY">-NA-</b> <span tabindex="-1" class="text-primary" role="button" data-toggle="popover" data-trigger="focus" title="" data-content="S tranche gets a variable interest rate." data-original-title="S Tranche Rate"><i class="fa fa-info-circle"></i></span>
														    			<br>AA Tranche APY: <b id="hDaiAdapterAAHighestAPY">-NA-</b>
																		<br> A Tranche APY: <b id="hDaiAdapterAHighestAPY">-NA-</b>
																	</p>
															</div>
														</div>
													</div>
												</div>
											</div>
											<!-- End col -->
											<!-- Start col -->
											<div class="col-lg-12 col-xl-8">
												<!-- Start row -->
												<div class="row m-t-10">
													<!-- Start col -->
													<div class="col-lg-12 col-xl-4">
														<div class="card h-100">
															<div class="card-body">
																<div class="row align-items-start no-gutters">
																	<div class="col-8">
																		<p class="font-15">Principal Tokens</p>
																		<h4 id="hPortfolioPrincipalTokensDAI" class="card-title mb-0 text-nowrap">-NA-</h4> </div>
																	<div class="col-4 text-right"> <span class="iconbar iconbar-md bg-primary text-white rounded"><i class="ri-money-dollar-circle-line align-unset"></i></span> </div>
																</div>
															</div>
														</div>
													</div>
													<!-- End col -->
													<!-- Start col -->
													<div class="col-lg-12 col-xl-4">
														<div class="card h-100">
															<div class="card-body">
																<div class="row align-items-start no-gutters">
																	<div class="col-8">
																		<p class="font-15">Interest Earned</p>
																		<h4 id="hInterestEarnedDAI" class="card-title mb-0 text-nowrap">-NA-</h4> </div>
																	<div class="col-4 text-right"> <span class="iconbar iconbar-md bg-primary text-white rounded"><i class="ri-moon-clear-line align-unset"></i></span> </div>
																</div>
															</div>
														</div>
													</div>
													<!-- End col -->
													<!-- Start col -->
													<div class="col-lg-12 col-xl-4">
														<div class="card h-100">
															<div class="card-body">
																<div class="row align-items-start no-gutters">
																	<div class="col-8">
																		<p class="font-15">SFI Earned <span tabindex="-1" class="text-primary" role="button" data-toggle="popover" data-trigger="focus" title="" data-content="SFI is mined by adding liquidity into the S, AA, or A tranches. The AA tranche has the highest SFI return but earns the lowest amount of interest." data-original-title="SFI Earned"><i class="fa fa-info-circle"></i></span> </p>
																		<h4 id="hSfiTokensEarnedDAI" class="card-title mb-0 text-nowrap">-NA-</h4> </div>
																	<div class="col-4 text-right"> <span class="iconbar iconbar-md bg-primary text-white rounded"><i class="ri-coin-line align-unset"></i></span> </div>
																</div>
															</div>
														</div>
													</div>
													<!-- End col -->
												</div>
												<!-- End row -->
											</div>
											<!-- End col -->
										</div>
										<!-- End row -->
									</div>
								</div>
							</div>
							<!-- End col -->
						</div>
						<!-- End row -->
					</div>
					<!-- End Contentbar -->
				</div>
				<div class="tab-pane fade" id="docs">
					<!-- Start Breadcrumbbar -->
					<div class="breadcrumbbar">
						<div class="row align-items-center">
							<div class="col-md-8 col-lg-8">
								<h4 class="page-title">Docs</h4>
								<div class="breadcrumb-list">
									<ol class="breadcrumb">
										<li class="breadcrumb-item"><a href="#home">Home</a></li>
										<li class="breadcrumb-item"><a href="#docs">Docs</a></li>
									</ol>
								</div>
							</div>
							<!--
		                    <div class="col-md-4 col-lg-4">
		                        <div class="widgetbar">
		                            <button class="btn btn-primary refresh"><i class="fa fa-refresh fa-fw mr-2"></i>Refresh</button>
		                        </div>                        
		                    </div>
                        --></div>
					</div>
					<!-- End Breadcrumbbar -->
					<!-- Start Contentbar -->
					<div class="contentbar">
						<!-- Start row -->
						<div class="row">
							<!-- Start col -->
							<div class="col-lg-10 col-xl-9">
								<div class="card m-b-30">
									<div class="card-body">
										<h1>saffron&#8203;.finance</h1>
										<p class="mt-3 mb-5" style="line-height:1.6em;"> Existing decentralized earning platforms expose liquidity providers to complex code driven outcomes. Network participants must evaluate an array of catastrophic scenarios where the resulting state could wipe out their holdings or lead to significant impermanent loss. It is hard to anticipate the net effect of extreme market volatility or focused economic attacks. Saffron narrows the set of possible outcomes by giving liquidity providers dynamic exposure. </p>
										<div class="mb-5 media"> <img class="mr-3 media-saffron-logo" src="assets/images/saffron.svg" alt="Saffron">
											<div class="media-body">
												<h5 class=" mt-0 font-16">Pools</h5> The saffron.finance system consists of pools of liquidity. Pools in saffron.finance collect deposited base assets from liquidity providers and deploy them on platforms to earn interest. For example, the first Saffron pool is the DAI pool, which launched with a DAI/Compound adapter. </div>
										</div>
										<div class="mb-5 media"> <img class="mr-3 media-saffron-logo" src="assets/images/saffron.svg" alt="Saffron">
											<div class="media-body">
												<h5 class=" mt-0 font-16">Adapters</h5> Adapters connect pooled capital to platforms. The first adapter is a DAI/Compound adapter. The DAI/Compound adapter, as its name suggests, connects the DAI pool to the Compound platform giving DAI pool LPs the opportunity to pool together and earn interest on Compound. </div>
										</div>
										<div class="mb-5 media"> <img class="mr-3 media-saffron-logo" src="assets/images/saffron.svg" alt="Saffron">
											<div class="media-body">
												<h5 class=" mt-0 font-16">Strategy</h5> The strategy connects all pools and adapters together and selects the best adapter to deploy capital to every hour for each pool. It also generates and distributes SFI tokens to LPs at the end of every epoch. </div>
										</div>
										<div class="mb-5 media"> <img class="mr-3 media-saffron-logo" src="assets/images/saffron.svg" alt="Saffron">
											<div class="media-body">
												<h5 class=" mt-0 font-16">Epochs</h5> Epochs are two week periods where liquidity is locked up and deployed to platforms by the system. At the end of an epoch it is wound down and the interest earned is calculated and can be distributed to LPs according to their proportional tranche ownership. During the wind down SFI tokens are generated and can be redeemed using the same proportional calculation used to redeem interest. In the first version of the Saffron, capital is only deployed on yield farming platforms, but in later versions Saffron will be able to create dynamic risk selection for LPs by adapting to different types of DeFi protocols. The first epoch (epoch 0) starts on 2020-10-31 at 14:10:00 UTC. </div>
										</div>
										<div class="mb-5 media"> <img class="mr-3 media-saffron-logo" src="assets/images/saffron.svg" alt="Saffron">
											<div class="media-body">
												<h5 class=" mt-0 font-16">SFI</h5> The SFI token is capped at 100,000 and is generated every 2 weeks during the wind down of an epoch. Tokens are earned by LPs proportional to how many dollars per second (dsec) they provided to the system for the duration of an epoch. SFI token subsidy is halved every epoch until epoch 8. From that point on, the system steadily releases 200 SFI tokens per epoch, until reaching the 100,000 cap. There are no fees on Saffron in version 1. Later versions will introduce Saffron platform fees, and at that time, staking SFI tokens will earn SFI holders a proportion of fees incurred by users. When SFI token generation ends, fees will continue to provide incentives to liquidity providers. SFI tokens must be staked for LPs to join the enhanced return A tranche. </div>
										</div>
										<div class="mb-5 media"> <img class="mr-3 media-saffron-logo" src="assets/images/saffron.svg" alt="Saffron">
											<div class="media-body">
												<h5 class=" mt-0 font-16">Tranches</h5>
												<p>Pools are divided up into tranches each with their own unique properties. There are three user-facing tranches for LPs to add liquidity into and two backend tranches that exist only at the smart contract level to provide LPs with aditional optionality when adding liquidity. The risky, high interest earning tranche (tranche A) earns interest according to its principal contribution multiplied by the tranche interest multiplier. The tranche interest multiplier defaults to 10. As a result, A tranche LPs earn 10x more interest than they would without saffron.finance, likewise AA tranche LPs earn 1/10th of the interest they normally would.</p>
												<ul>
													<li class="mb-1"><b>AA Tranche</b>: LPs adding liquidity to the AA tranche earn less interest but are covered in the case of loss from platform risk. That covered capital comes from the principal and interest earnings of A tranche LPs. AA tranche LPs are awarded with 80% of the SFI token generation.</li>
													<li class="mb-1"><b>A Tranche</b>: LPs adding liquidity to the A tranche earn more interest but lose their principal and interest earnings in case of loss from platform risk. A tranche LPs earn 10% of the SFI tokens generated per epoch. SFI earnings are not included in covering first loss for AA tranche LPs.</li>
													<li class="mb-1"><b>S Tranche</b>: The S tranche earns 10% of SFI generated per epoch. The system uses the S tranche to balance the A and AA tranches such that they are always in a perfect equilibrium with each other such that the tranche interest multiplier is maintained at its exact value. For example, with a tranche interest multiplier of 10, the AA:A ratio in a pool is always 10:1.</li>
												</ul>
											</div>
										</div>
									</div>
								</div>
								<!-- End Contentbar -->
							</div>
						</div>
						<!-- Start Footerbar -->
						<div class="footerbar">
							<footer class="footer">
								<p class="mb-0">Â© 2020 Saffron Finance - All Rights Reserved.</p>
							</footer>
						</div>
						<!-- End Footerbar -->
					</div>
					<!-- End Rightbar -->
				</div>
				<div class="tab-pane fade" id="community">
					<!-- Start Breadcrumbbar -->
					<div class="breadcrumbbar">
						<div class="row align-items-center">
							<div class="col-md-8 col-lg-8">
								<h4 class="page-title">Community</h4>
								<div class="breadcrumb-list">
									<ol class="breadcrumb">
										<li class="breadcrumb-item"><a href="#home">Home</a></li>
										<li class="breadcrumb-item"><a href="#community">Community</a></li>
									</ol>
								</div>
							</div>
							<!--
            <div class="col-md-4 col-lg-4">
                <div class="widgetbar">
                    <button class="btn btn-primary refresh"><i class="fa fa-refresh fa-fw mr-2"></i>Refresh</button>
                </div>
            </div>
--></div>
					</div>
					<!-- End Breadcrumbbar -->
					<!-- Start Contentbar -->
					<div class="contentbar">
						<div class="row">
							<!-- Start col -->
							<div class="col-lg-4 col-xl-4">
								<div class="card m-b-30">
									<div class="card-body">
										<div class="media"> <a target="_blank" href="https://t.me/saffronfinance"><img class="mr-3 media-saffron-logo" src="assets/images/telegram.png" alt="telegram"></a>
											<div class="media-body">
												<h5 class=" mt-0 font-16">Telegram</h5> Join the community discussion on Telegram
												<br/><a target="_blank" href="https://t.me/saffronfinance">https://t.me/saffronfinance</a> </div>
										</div>
									</div>
								</div>
							</div>
							<!-- End col -->
							<!-- Start col -->
							<div class="col-lg-4 col-xl-4">
								<div class="card m-b-30">
									<div class="card-body">
										<div class="media"> <a target="_blank" href="https://discord.gg/pDXpXKY"><img class="mr-3 media-saffron-logo" src="assets/images/discord.png" alt="discord"></a>
											<div class="media-body">
												<h5 class=" mt-0 font-16">Discord</h5> Chat with the Saffron community on Discord
												<br/><a target="_blank" href="https://discord.gg/pDXpXKY">https://discord.gg/pDXpXKY</a> </div>
										</div>
									</div>
								</div>
							</div>
							<!-- End col -->
							<!-- Start col -->
							<div class="col-lg-4 col-xl-4">
								<div class="card m-b-30">
									<div class="card-body">
										<div class="media"> <a target="_blank" href="https://github.com/saffron-finance/saffron"><img class="mr-3 media-saffron-logo" src="assets/images/github.png" alt="github"></a>
											<div class="media-body">
												<h5 class=" mt-0 font-16">GitHub</h5> View the code on GitHub
												<br/><a target="_blank" href="https://github.com/saffron-finance/saffron">github.com/saffron-finance/saffron</a> </div>
										</div>
									</div>
								</div>
							</div>
							<!-- End col -->
						</div>
						<!-- End Row-->
						<div class="row">
							<!-- Start col -->
							<div class="col-lg-4 col-xl-4">
								<div class="card m-b-30">
									<div class="card-body">
										<div class="media"> <a target="_blank" href="https://twitter.com/saffronfinance_"><img class="mr-3 media-saffron-logo" src="assets/images/twitter.png" alt="twitter"></a>
											<div class="media-body">
												<h5 class=" mt-0 font-16">Twitter</h5> Follow Saffron on Twitter @saffronfinance_
												<br/><a target="_blank" href="https://twitter.com/saffronfinance_">https://twitter.com/saffronfinance_</a> </div>
										</div>
									</div>
								</div>
							</div>
							<!-- End col -->
							<!-- Start col -->
							<div class="col-lg-4 col-xl-4">
								<div class="card m-b-30">
									<div class="card-body">
										<div class="media"> <a target="_blank" href="https://medium.com/saffron-finance"><img class="mr-3 media-saffron-logo" src="assets/images/medium.png" alt="medium"></a>
											<div class="media-body">
												<h5 class=" mt-0 font-16">Medium</h5> Read more about Saffron on Medium
												<br/><a target="_blank" href="https://medium.com/saffron-finance">https://medium.com/saffron-finance</a> </div>
										</div>
									</div>
								</div>
							</div>
							<!-- End col -->
							<!-- Start col -->
							<div class="col-lg-4 col-xl-4">
								<div class="card m-b-30">
									<div class="card-body">
										<div class="media"> <a target="_blank" href="#"><img class="mr-3 media-saffron-logo" src="assets/images/defipulse.png" alt="medium"></a>
											<div class="media-body">
												<h5 class=" mt-0 font-16">DeFi Pulse</h5> Check out our DeFi Pulse listing
												<br/><a target="_blank" href="#" onclick="swal({title:'Coming Soon!',html:'<h5>Saffron will soon be listed on<br><a target=&quot;_blanck&quot; href=&quot;https://defipulse.com&quot;>Defipulse.com</a></h5>',showConfirmButton:true,imageUrl:'assets/images/saffron.png',imageWidth:'48px'});return false;">Coming soon</a> </div>
										</div>
									</div>
								</div>
							</div>
							<!-- End col -->
						</div>
						<!-- End Row-->
					</div>
					<!-- End Contentbar -->
				</div>
			</div>
		</div>
		<!-- End Containerbar -->
	</div>
	<!-- End... containerbar?-->
	<!-- Start Modals -->
	<!-- Start Saffron Alert Modal -->
	<div class="modal fade" id="modalAlertSaffron" data-backdrop="static" tabindex="-1" aria-hidden="true" style="z-index:1060;">
		<div class="modal-dialog slideInDown  animated">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="modalAlertHeader">Saffron Alert!</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">&times;</span> </button>
				</div>
				<div class="modal-body">
					<p id="modalAlertMessage"></p>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-primary" data-dismiss="modal">Got it, thanks!</button>
				</div>
			</div>
		</div>
	</div>
	<!-- End Saffron Alert Modal -->
	<!-- begin connect wallet modal -->
	<div class="modal fade" id="modalConnectWallet" data-backdrop="static" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Connect Your Wallet</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">&times;</span> </button>
				</div>
				<div class="modal-body">
					<div class="container">
						<div class="row">
							<div class="col-lg-6 col-md-12">
								<button class="btn btn-primary btn-lg btn-wallet btn-block" data-dismiss="modal" data-wallet-name="metamask"> <img src="assets/images/logo-metamask-32.png" alt="">MetaMask </button>
							</div>
							<div class="col-lg-6 col-md-12">
								<button class="btn btn-primary btn-lg btn-wallet btn-block" disabled data-dismiss="modal" data-wallet-name="fortmatic"> <img src="assets/images/logo-fortmatic-32.png" alt="">Fortmatic </button>
							</div>
						</div>
						<div class="row">
							<div class="col-lg-6 col-md-12">
								<button class="btn btn-primary btn-lg btn-wallet btn-block" disabled data-dismiss="modal" data-wallet-name="authereum"> <img src="assets/images/logo-authereum-32.png" alt="">Authereum </button>
							</div>
							<div class="col-lg-6 col-md-12">
								<button class="btn btn-primary btn-lg btn-wallet btn-block" disabled data-dismiss="modal" data-wallet-name="coinbase"> <img src="assets/images/logo-coinbase-32.png" alt="">Coinbase </button>
							</div>
						</div>
						<div class="row">
							<div class="col-lg-6 col-md-12">
								<button class="btn btn-primary btn-lg btn-wallet btn-block" disabled data-dismiss="modal" data-wallet-name="ledger"> <img src="assets/images/logo-ledger-32.png" alt="">Ledger </button>
							</div>
							<div class="col-lg-6 col-md-12">
								<button class="btn btn-primary btn-lg btn-wallet btn-block" disabled data-dismiss="modal" data-wallet-name="portis"> <img src="assets/images/logo-portis-32.png" alt="">Portis </button>
							</div>
						</div>
						<div class="row">
							<div class="col-lg-6 col-md-12">
								<button class="btn btn-primary btn-lg btn-wallet btn-block" disabled data-dismiss="modal" data-wallet-name="squarelink"> <img src="assets/images/logo-squarelink-32.png" alt="">Squarelink </button>
							</div>
							<div class="col-lg-6 col-md-12">
								<button class="btn btn-primary btn-lg btn-wallet btn-block" disabled data-dismiss="modal" data-wallet-name="torus"> <img src="assets/images/logo-torus-32.png" alt="">Torus </button>
							</div>
						</div>
						<div class="row">
							<div class="col-lg-6 col-md-12">
								<button class="btn btn-primary btn-lg btn-wallet btn-block" disabled data-dismiss="modal" data-wallet-name="trezor"> <img src="assets/images/logo-trezor-32.png" alt="">Trezor </button>
							</div>
							<div class="col-lg-6 col-md-12">
								<button class="btn btn-primary btn-lg btn-wallet btn-block" disabled data-dismiss="modal" data-wallet-name="trezor"> <img src="assets/images/logo-walletconnect-32.png" alt="">Wallet Connect </button>
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary btn-lg" data-dismiss="modal">Cancel</button>
				</div>
			</div>
		</div>
	</div>
	<!-- end connect wallet modal -->
	<!-- begin deposit dai modal -->
	<div class="modal fade" id="modalDepositDai" data-backdrop="static" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title"><img src="assets/images/dai.png" alt="dai"> Deposit DAI</h5>
					<button id="btnCancelAddLiquidity" type="button" class="close" data-dismiss="modal" aria-label="Close" data-deposit-dai-button="cancel"> <span aria-hidden="true">&times;</span> </button>
				</div>
				<div class="modal-body">
					<div class="container-fluid">
						<!-- Start row -->
						<div class="row">
							<!-- Start col -->
							<div class="col">
								<!-- Start card -->
								<div class="card m-b-10">
									<!-- Start card body -->
									<div class="card-body">
										<h5 class="card-title">Select Tranche</h5>
										<!-- Start row -->
										<div class="row custom-radio-button">
											<!-- Start col -->
											<div class="col-md-12 col-lg-4 d-flex align-items-start flex-column mb-4 mb-lg-0">
												<div class="form-check form-check-inline radio-warning">
													<input class="form-check-input" type="radio" name="modalDepositDaiTranches" id="modalDepositS" value="0" checked="">
													<label class="form-check-label p-l-10" for="modalDepositS"> <b class="text-nowrap">S Tranche</b> </label>
												</div>
												<p class="card-text">Liquidity added to other tranches as needed.</p>
												<div class="mt-auto">
													<p class="card-text" style="display:none">SFI earnings: <b id="trancheSFIMultiplierS">-NA-</b>
													<p class="card-text">SFI earnings: <b id="temporarySFIEarningsEpoch0">100%</b>
														<br>APY: <b id="tranchApyS">-NA-</b>
													</p>
												</div>

											</div>
											<!-- End col -->
											<!-- Start col -->
											<div class="col-md-12 col-lg-4 d-flex align-items-start flex-column mb-4 mb-lg-0" style="opacity:.4;">
												<div class="form-check form-check-inline radio-success">
													<input disabled class="form-check-input" type="radio" name="modalDepositDaiTranches" id="modalDepositAA" value="1">
													<label class="form-check-label p-l-10" for="modalDepositAA"> <b class="text-nowrap">AA Tranche</b> </label>
												</div>
												<p class="card-text">Reduce interest earned. Covered in case of platform failure.</p>
												<div class="mt-auto" style="opacity:.4;">
													<p class="card-text">SFI earnings: <b id="trancheSFIMultiplierAA">-NA-</b>
														<br>APY: <b id="tranchApyAA">-NA-</b>
													</p>
												</div>
											</div>
											<!-- End col -->
											<!-- Start col -->
											<div class="col-md-12 col-lg-4 d-flex align-items-start flex-column" style="opacity:.4;">
												<div class="form-check form-check-inline radio-danger">
													<input disabled class="form-check-input" type="radio" name="modalDepositDaiTranches" id="modalDepositA" value="2">
													<label class="form-check-label p-l-10" for="modalDepositA"> <b class="text-nowrap">A Tranche</b> </label>
												</div>
												<p class="card-text"><span id="spanATrancheMultiplier">10</span>X interest earned. Cover provided for AA tranche.</p>
												<div class="mt-auto" style="opacity:.4;">
													<p class="card-text">SFI earnings: <b id="trancheSFIMultiplierA">-NA-</b>
														<br>APY: <b id="tranchApyA">-NA-</b>
													</p>
												</div>
											</div>
											<!-- End col -->
										</div>
										<!-- End row -->
									</div>
									<!-- End card body -->
								</div>
								<!-- End card -->
							</div>
							<!-- End col -->
						</div>
						<!-- End row -->
						<!-- Start row -->
						<div class="row">
							<!-- Start col -->
							<div class="col">
								<!-- Start card -->
								<div class="card m-b-10">
									<!-- Start card body -->
									<div class="card-body">
										<h5 class="card-title">Select Amount</h5>
										<!-- Start row -->
										<div class="row">
											<!-- Start col -->
											<div class="col">
												<label>Available DAI</label>
												<br>
												<h4 class="mt-1" id="modalDepositDaiBalance">-NA-</h4> </div>
											<!-- End col -->
											<!-- Start col -->
											<div class="col-lg-auto mb-3 mb-lg-0">
												<label>Use % Of Available Amount</label>
												<br>
												<div class="btn-group">
													<button type="button" class="btn btn-green amountPercent" data-from="depositDaiBalance" data-to="modalDepositDaiAmount" data-percent=".25">25% <i class="dripicons-arrow-right"></i></button>
													<button type="button" class="btn btn-yellow amountPercent" data-from="depositDaiBalance" data-to="modalDepositDaiAmount" data-percent=".5">50% <i class="dripicons-arrow-right"></i></button>
													<button type="button" class="btn btn-orange amountPercent" data-from="depositDaiBalance" data-to="modalDepositDaiAmount" data-percent=".75">75% <i class="dripicons-arrow-right"></i></button>
													<button type="button" class="btn btn-red amountPercent" data-from="depositDaiBalance" data-to="modalDepositDaiAmount" data-percent="1.0">100% <i class="dripicons-arrow-right"></i></button>
												</div>
											</div>
											<!-- End col -->
											<!-- Start col -->
											<div class="col">
												<label for="modalDepositDaiAmount">Deposit Amount</label>
												<br>
												<div class="input-group">
													<input type="text" class="form-control" id="modalDepositDaiAmount" name="inputmask-currency" placeholder="$ 0.00" style="text-align: right;">
													<div class="input-group-append"> <span class="input-group-text">DAI</span> </div>
													<div class="invalid-tooltip"> Please provide a valid amount </div>
												</div>
											</div>
											<!-- End col -->
										</div>
										<!-- End row -->
									</div>
									<!-- End card body -->
								</div>
								<!-- End card -->
							</div>
							<!-- End col -->
						</div>
						<!-- End row -->
						<!-- Start row -->
						<div class="row">
							<!-- Start col -->
							<div class="col">
								<div class="card m-b-10">
									<div class="card-body">
										<h5 class="card-title">Select Duration</h5>
										<p class="card-subtitle">Select duration of deposit. You can remove liquidity at the end of every 2 week epoch.</p>
										<input data-disable="true" id="modal-pool-duration-slider">
										<p class="mt-2">Redemption Date: <b id="modalDepositDaiRedeemDate">-NA-</b> <span tabindex="-1" class="text-primary" role="button" data-toggle="popover" data-trigger="focus" title="Redemption Date" data-content="You can only remove liquidity after the end of the 2 week epoch that you deposited it in." data-original-title="SFI Earned"><i class="fa fa-info-circle"></i></span></p>
									</div>
								</div>
							</div>
							<!-- End col -->
						</div>
						<!-- End row -->
					</div>
				</div>
				<div class="modal-footer">
					<button id="btnAddLiquidity" type="button" class="btn btn-primary" data-deposit-dai-button="confirm"><i class="fa fa-refresh fa-spin fa-fw mr-2 hide"></i> Confirm Deposit</button>
					<button id="btnCancelAddLiquidity2" type="button" class="btn btn-secondary btn-lg" data-dismiss="modal" data-deposit-dai-button="cancel">Cancel</button>
				</div>
			</div>
		</div>
	</div>
	<!-- end deposit dai modal -->
	<!-- begin redeem dai modal -->
	<div class="modal fade" id="modalRedeemDai" data-backdrop="static" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title"><img src="assets/images/dai.png" alt="dai"> Redeem DAI</h5>
					<button id="btnCancelRemoveLiquidity" type="button" class="close" data-dismiss="modal" aria-label="Close" data-deposit-dai-button="cancel"> <span aria-hidden="true">&times;</span> </button>
				</div>
				<div class="modal-body">
					<div class="container-fluid">
						<!-- Start row -->
						<div class="row">
							<!-- Start col -->
							<div class="col">
								<!-- Start card -->
								<div class="card m-b-10">
									<!-- Start card body -->
									<div class="card-body">
										<h5 class="card-title">Select Tranche</h5>
										<!-- Start row -->
										<div class="row custom-radio-button">
											<!-- Start col -->
											<div class="col-md-12 col-lg-4 d-flex align-items-start flex-column mb-4 mb-lg-0">
												<div class="form-check form-check-inline radio-warning">
													<input class="form-check-input" type="radio" name="modalRedeemDaiTranches" id="modalRedeemS" value="0" checked="">
													<label class="form-check-label p-l-10" for="modalRedeemS"> <b class="text-nowrap">S Tranche</b> </label>
												</div>
												<p class="card-text">Liquidity added to other tranches as needed.</p>
											</div>
											<!-- End col -->
											<!-- Start col -->
											<div class="col-md-12 col-lg-4 d-flex align-items-start flex-column mb-4 mb-lg-0">
												<div class="form-check form-check-inline radio-success">
													<input class="form-check-input" type="radio" name="modalRedeemDaiTranches" id="modalRedeemAA" value="1">
													<label class="form-check-label p-l-10" for="modalRedeemAA"> <b class="text-nowrap">AA Tranche</b> </label>
												</div>
												<p class="card-text">Reduce interest earned. Covered in case of platform failure.</p>
											</div>
											<!-- End col -->
											<!-- Start col -->
											<div class="col-md-12 col-lg-4 d-flex align-items-start flex-column">
												<div class="form-check form-check-inline radio-danger">
													<input class="form-check-input" type="radio" name="modalRedeemDaiTranches" id="modalRedeemA" value="2">
													<label class="form-check-label p-l-10" for="modalRedeemA"> <b class="text-nowrap">A Tranche</b> </label>
												</div>
												<p class="card-text"><span id="spanATrancheMultiplierRedeem">10</span>X interest earned. Cover provided for AA tranche.</p>
											</div>
											<!-- End col -->
										</div>
										<!-- End row -->
									</div>
									<!-- End card body -->
								</div>
								<!-- End card -->
							</div>
							<!-- End col -->
						</div>
						<!-- End row -->
						<!-- Start row -->
						<div class="row">
							<!-- Start col -->
							<div class="col">
								<!-- Start card -->
								<div class="card m-b-10">
									<!-- Start card body -->
									<div class="card-body">
										<h5 class="card-title">Redeem Principal, Interest, and SFI</h5>
										<!-- Start row -->
										<div class="row custom-radio-button">
											<!-- Start col -->
											<div class="col-md-12 col-lg-4 d-flex align-items-start flex-column mb-4 mb-lg-0">
												<div class="form-check form-check-inline radio-primary">
													<input class="form-check-input" type="radio" name="modalRedeemWhat" id="modalRedeemPrincipal" value="0" checked="">
													<label class="form-check-label p-l-10" for="modalRedeemPrincipal"> <b>Redeem Principal</b> </label>
												</div>
											</div>
											<!-- End col -->
											<!-- Start col -->
											<div class="col-md-12 col-lg-4 d-flex align-items-start flex-column mb-4 mb-lg-0">
												<div class="form-check form-check-inline radio-primary">
													<input class="form-check-input" type="radio" name="modalRedeemWhat" id="modalRedeemInterestSFI" value="1">
													<label class="form-check-label p-l-10" for="modalRedeemInterestSFI"> <b>Redeem Interest/SFI</b> </label>
												</div>
											</div>
											<!-- End col -->
											<!-- Start col -->
											<div class="col-md-12 col-lg-4 d-flex align-items-start flex-column">
												<div class="form-check form-check-inline radio-primary">
													<input class="form-check-input" type="radio" name="modalRedeemWhat" id="modalRedeemBoth" value="2">
													<label class="form-check-label p-l-10" for="modalRedeemBoth"> <b>Redeem Both</b> </label>
												</div>
											</div>
											<!-- End col -->
										</div>
										<!-- End row -->
									</div>
									<!-- End card body -->
								</div>
								<!-- End card -->
							</div>
							<!-- End col -->
						</div>
						<!-- End row -->
						<!-- Start row -->
						<div id="rowRedeemPrincipal" class="row">
							<!-- Start col -->
							<div class="col">
								<!-- Start card -->
								<div class="card m-b-10">
									<!-- Start card body -->
									<div class="card-body">
										<h5 class="card-title">Redeem Principal</h5>
										<!-- Start row -->
										<div class="row">
											<!-- Start col -->
											<div class="col">
												<label>DAI Held In Pool</label>
												<br>
												<h4 class="mt-1" id="modalRedeemPrincipalBalance">-NA-</h4> </div>
											<!-- End col -->
											<!-- Start col -->
											<div class="col-lg-auto mb-3 mb-lg-0">
												<label>Use % Of Available Amount</label>
												<br>
												<div class="btn-group">
													<button type="button" class="btn btn-green amountPercent" data-from="redeemPrincipalBalance" data-to="modalRedeemPrincipalAmount" data-percent=".25">25% <i class="dripicons-arrow-right"></i></button>
													<button type="button" class="btn btn-yellow amountPercent" data-from="redeemPrincipalBalance" data-to="modalRedeemPrincipalAmount" data-percent=".5">50% <i class="dripicons-arrow-right"></i></button>
													<button type="button" class="btn btn-orange amountPercent" data-from="redeemPrincipalBalance" data-to="modalRedeemPrincipalAmount" data-percent=".75">75% <i class="dripicons-arrow-right"></i></button>
													<button type="button" class="btn btn-red amountPercent" data-from="redeemPrincipalBalance" data-to="modalRedeemPrincipalAmount" data-percent="1.0">100% <i class="dripicons-arrow-right"></i></button>
												</div>
											</div>
											<!-- End col -->
											<!-- Start col -->
											<div class="col">
												<label for="modalRedeemPrincipalAmount">Redemption Amount</label>
												<br>
												<div class="input-group">
													<input type="text" class="form-control" id="modalRedeemPrincipalAmount" name="inputmask-currency" placeholder="0.00" style="text-align: right;">
													<div class="input-group-append"> <span class="input-group-text" style="width:3.25rem;">DAI</span> </div>
													<div class="invalid-tooltip"> Please provide a valid amount </div>
												</div>
											</div>
											<!-- End col -->
										</div>
										<!-- End row -->
									</div>
									<!-- End card body -->
								</div>
								<!-- End card -->
							</div>
							<!-- End col -->
						</div>
						<!-- End row -->
						<!-- Start row -->
						<div id="rowRedeemInterestSFI" class="row">
							<!-- Start col -->
							<div class="col">
								<!-- Start card -->
								<div class="card m-b-10">
									<!-- Start card body -->
									<div class="card-body">
										<h5 class="card-title">Redeem Interest & SFI Rewards</h5>
										<!-- Start row -->
										<div class="row">
											<!-- Start col -->
											<div class="col">
												<label>Interest/SFI Earnings</label>
												<br>
												<h4 class="mt-1" id="modalRedeemInterestBalance">-NA-</h4>
												<h4 class="mt-1" id="modalRedeemSFIBalance">-NA-</h4> </div>
											<!-- End col -->
											<!-- Start col -->
											<div class="col-lg-auto mb-3 mb-lg-0o">
												<label>Redemption %</label>
												<br>
												<div class="btn-group">
													<button type="button" class="btn btn-green amountPercent" data-from="redeemInterestBalance,redeemSFIBalance" data-to="modalRedeemInterestAmount,modalRedeemSFIAmount" data-percent=".25">25% <i class="dripicons-arrow-right"></i></button>
													<button type="button" class="btn btn-yellow amountPercent" data-from="redeemInterestBalance,redeemSFIBalance" data-to="modalRedeemInterestAmount,modalRedeemSFIAmount" data-percent=".5">50% <i class="dripicons-arrow-right"></i></button>
													<button type="button" class="btn btn-orange amountPercent" data-from="redeemInterestBalance,redeemSFIBalance" data-to="modalRedeemInterestAmount,modalRedeemSFIAmount" data-percent=".75">75% <i class="dripicons-arrow-right"></i></button>
													<button type="button" class="btn btn-red amountPercent" data-from="redeemInterestBalance,redeemSFIBalance" data-to="modalRedeemInterestAmount,modalRedeemSFIAmount" data-percent="1.0">100% <i class="dripicons-arrow-right"></i></button>
												</div>
												<br> </div>
											<!-- End col -->
											<!-- Start col -->
											<div class="col">
												<label for="modalRedeemInterestAmount">Redemption Amounts</label>
												<br>
												<div class="input-group">
													<input type="text" class="form-control" id="modalRedeemInterestAmount" name="inputmask-currency" placeholder="0.00" style="text-align: right;">
													<div class="input-group-append"> <span class="input-group-text" style="width:3.25rem;">DAI</span> </div>
													<div class="invalid-tooltip"> Please provide a valid amount </div>
												</div>
												<div class="input-group">
													<input type="text" class="form-control" id="modalRedeemSFIAmount" name="inputmask-currency" placeholder="0.00" style="text-align: right;">
													<div class="input-group-append"> <span class="input-group-text" style="width:3.25rem;">SFI</span> </div>
													<div class="invalid-tooltip"> Please provide a valid amount </div>
												</div>
											</div>
											<!-- End col -->
										</div>
										<!-- End row -->
									</div>
									<!-- End card body -->
								</div>
								<!-- End card -->
							</div>
							<!-- End col -->
						</div>
						<!-- End row -->
					</div>
				</div>
				<div class="modal-footer">
					<button id="btnRemoveLiquidity" type="button" class="btn btn-primary" data-deposit-dai-button="confirm"><i class="fa fa-refresh fa-spin fa-fw mr-2 hide"></i> Confirm Redeem</button>
					<button id="btnCancelRemoveLiquidity2" type="button" class="btn btn-secondary btn-lg" data-dismiss="modal" data-deposit-dai-button="cancel">Cancel</button>
				</div>
			</div>
		</div>
	</div>
	<!-- end redeem dai modal -->
	<!-- End Modals -->
	<!-- Start js -->
	<script src="assets/js/bignumber.min.js"></script>
	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/popper.min.js"></script>
	<script src="assets/js/bootstrap.min.js"></script>
	<script src="assets/js/modernizr.min.js"></script>
	<script src="assets/js/detect.js"></script>
	<script src="assets/js/jquery.slimscroll.js"></script>
	<!--     <script src="assets/js/vertical-menu.js"></script> -->
	<!-- Switchery js -->
	<script src="assets/plugins/switchery/switchery.min.js"></script>
	<!-- Sweet-Alert js -->
	<script src="assets/plugins/sweet-alert2/sweetalert2.min.js"></script>
	<!-- Range Slider js -->
	<script src="assets/plugins/ion-rangeSlider/ion.rangeSlider.min.js"></script>
	<!--     <script src="assets/js/custom/custom-range-slider.js"></script> -->
	<!-- Apex js -->
	<script src="assets/plugins/apexcharts/apexcharts.min.js"></script>
	<script src="assets/plugins/apexcharts/irregular-data-series.js"></script>
	<!-- Slick js -->
	<script src="assets/plugins/slick/slick.min.js"></script>
	<!-- Custom Dashboard js -->
	<!--<script src="assets/js/custom/custom-dashboard.js"></script>-->
	<!-- Core js -->
	<script src="assets/js/core.js"></script>
	<!-- Web3 js -->
	<script src="https://unpkg.com/web3@latest/dist/web3.min.js"></script>
	<!-- ts particles -->
	<script src="assets/js/tsparticles.min.js"></script>
	<script src="assets/plugins/jquery-countdown/jquery.countdown.min.js"></script>
	<!-- page js -->
	<script>
	var web3; // =new Web3(new Web3.providers.HttpProvider("https://kovan.infura.io/v3/6aac9868208f4de6a6eb2246d022f38f"));
	var ethConnected=false
	var currentAccount="0x";
	var chainInfo;
	var conn,walletAddress,networkName;
	var chainIds=[{"name":"Ethereum Mainnet","chainId":1,"shortName":"eth","chain":"ETH","network":"mainnet","networkId":1,"nativeCurrency":{"name":"Ether","symbol":"ETH","decimals":18},"rpc":["https://mainnet.infura.io/v3/${INFURA_API_KEY}","https://api.mycryptoapi.com/eth"],"faucets":[],"infoURL":"https://ethereum.org"},{"name":"xDAI Chain","chainId":100,"shortName":"xdai","chain":"XDAI","network":"mainnet","networkId":100,"nativeCurrency":{"name":"xDAI","symbol":"xDAI","decimals":18},"rpc":["https://dai.poa.network"],"faucets":[],"infoURL":"https://forum.poa.network/c/xdai-chain"},{"name":"EtherInc","chainId":101,"shortName":"eti","chain":"ETI","network":"mainnet","networkId":1,"nativeCurrency":{"name":"EtherInc Ether","symbol":"ETI","decimals":18},"rpc":["https://api.einc.io/jsonrpc/mainnet"],"faucets":[],"infoURL":"https://einc.io"},{"name":"ThunderCore Mainnet","chainId":108,"shortName":"TT","chain":"TT","network":"mainnet","networkId":108,"nativeCurrency":{"name":"ThunderCore Mainnet Ether","symbol":"TT","decimals":18},"rpc":["https://mainnet-rpc.thundercore.com"],"faucets":["https://faucet.thundercore.com"],"infoURL":"https://thundercore.com"},{"name":"Metadium Mainnet","chainId":11,"shortName":"meta","chain":"META","network":"mainnet","networkId":11,"nativeCurrency":{"name":"Metadium Mainnet Ether","symbol":"META","decimals":18},"rpc":["https://api.metadium.com/prod"],"faucets":[],"infoURL":"https://metadium.com"},{"name":"IPOS Network","chainId":1122334455,"shortName":"ipos","chain":"IPOS","network":"mainnet","networkId":1122334455,"nativeCurrency":{"name":"IPOS Network Ether","symbol":"IPOS","decimals":18},"rpc":["https://rpc.iposlab.com","https://rpc2.iposlab.com"],"faucets":[],"infoURL":"https://iposlab.com"},{"name":"Metadium Testnet","chainId":12,"shortName":"kal","chain":"META","network":"testnet","networkId":12,"nativeCurrency":{"name":"Metadium Testnet Ether","symbol":"KAL","decimals":18},"rpc":["https://api.metadium.com/dev"],"faucets":[],"infoURL":"https://metadium.com"},{"name":"Fuse Mainnet","chainId":122,"shortName":"fuse","chain":"FUSE","network":"mainnet","networkId":122,"nativeCurrency":{"name":"Fuse","symbol":"FUSE","decimals":18},"rpc":["https://rpc.fuse.io"],"faucets":[],"infoURL":"https://fuse.io/"},{"name":"Ether-1","chainId":1313114,"shortName":"etho","chain":"ETHO","network":"mainnet","networkId":1313114,"nativeCurrency":{"name":"Ether-1 Ether","symbol":"ETHO","decimals":18},"rpc":["https://rpc.ether1.org"],"faucets":[],"infoURL":"https://ether1.org"},{"name":"Xerom","chainId":1313500,"shortName":"xero","chain":"XERO","network":"mainnet","networkId":1313500,"nativeCurrency":{"name":"Xerom Ether","symbol":"XERO","decimals":18},"rpc":["https://rpc.xerom.org"],"faucets":[],"infoURL":"https://xerom.org"},{"name":"PepChain Churchill","chainId":13371337,"shortName":"tpep","chain":"PEP","network":"testnet","networkId":13371337,"nativeCurrency":{"name":"PepChain Churchill Ether","symbol":"TPEP","decimals":18},"rpc":["https://churchill-rpc.pepchain.io"],"faucets":[],"infoURL":"https://pepchain.io"},{"name":"Matic Mainnet","chainId":137,"shortName":"matic","chain":"Matic","network":"mainnet","networkId":137,"nativeCurrency":{"name":"Matic","symbol":"MATIC","decimals":18},"rpc":["https://rpc-mainnet.matic.network","wss://ws-mainnet.matic.network"],"faucets":[],"infoURL":"https://matic.network/"},{"name":"Lightstreams Testnet","chainId":162,"shortName":"tpht","chain":"PHT","network":"sirius","networkId":162,"nativeCurrency":{"name":"Lightstreams PHT","symbol":"PHT","decimals":18},"rpc":["https://node.sirius.lightstreams.io"],"faucets":["https://discuss.lightstreams.network/t/request-test-tokens"],"infoURL":"https://explorer.sirius.lightstreams.io"},{"name":"Atheios","chainId":1620,"shortName":"ath","chain":"ATH","network":"mainnet","networkId":11235813,"nativeCurrency":{"name":"Atheios Ether","symbol":"ATH","decimals":18},"rpc":["https://wallet.atheios.com:8797"],"faucets":[],"infoURL":"https://atheios.com"},{"name":"Lightstreams Mainnet","chainId":163,"shortName":"pht","chain":"PHT","network":"mainnet","networkId":163,"nativeCurrency":{"name":"Lightstreams PHT","symbol":"PHT","decimals":18},"rpc":["https://node.mainnet.lightstreams.io"],"faucets":[],"infoURL":"https://explorer.lightstreams.io"},{"name":"ThunderCore Testnet","chainId":18,"shortName":"TST","chain":"TST","network":"testnet","networkId":18,"nativeCurrency":{"name":"ThunderCore Testnet Ether","symbol":"TST","decimals":18},"rpc":["https://testnet-rpc.thundercore.com"],"faucets":["https://faucet-testnet.thundercore.com"],"infoURL":"https://thundercore.com"},{"name":"IOLite","chainId":18289463,"shortName":"ilt","chain":"ILT","network":"mainnet","networkId":18289463,"nativeCurrency":{"name":"IOLite Ether","symbol":"ILT","decimals":18},"rpc":["https://net.iolite.io"],"faucets":[],"infoURL":"https://iolite.io"},{"name":"Teslafunds","chainId":1856,"shortName":"tsf","chain":"TSF","network":"mainnet","networkId":1,"nativeCurrency":{"name":"Teslafunds Ether","symbol":"TSF","decimals":18},"rpc":["https://tsfapi.europool.me"],"faucets":[],"infoURL":"https://teslafunds.io"},{"name":"EtherGem","chainId":1987,"shortName":"egem","chain":"EGEM","network":"mainnet","networkId":1987,"nativeCurrency":{"name":"EtherGem Ether","symbol":"EGEM","decimals":18},"rpc":["https://jsonrpc.egem.io/custom"],"faucets":[],"infoURL":"https://egem.io"},{"name":"Expanse Network","chainId":2,"shortName":"exp","chain":"EXP","network":"mainnet","networkId":1,"nativeCurrency":{"name":"Expanse Network Ether","symbol":"EXP","decimals":18},"rpc":["https://node.expanse.tech"],"faucets":[],"infoURL":"https://expanse.tech"},{"name":"ELA-ETH-Sidechain Mainnet","chainId":20,"shortName":"ELAETHSC","chain":"ETH","network":"mainnet","networkId":1,"nativeCurrency":{"name":"Ether","symbol":"ETH","decimals":18},"rpc":["https://mainrpc.elaeth.io"],"faucets":[],"infoURL":"https://www.elastos.org/"},{"name":"Akaroma","chainId":200625,"shortName":"aka","chain":"AKA","network":"mainnet","networkId":200625,"nativeCurrency":{"name":"Akaroma Ether","symbol":"AKA","decimals":18},"rpc":["https://remote.akroma.io"],"faucets":[],"infoURL":"https://akroma.io"},{"name":"ELA-ETH-Sidechain Testnet","chainId":21,"shortName":"ELAETHSC","chain":"ETH","network":"testnet","networkId":2,"nativeCurrency":{"name":"Ether","symbol":"ETH","decimals":18},"rpc":["https://rpc.elaeth.io"],"faucets":["https://faucet.elaeth.io/"],"infoURL":"https://elaeth.io/"},{"name":"Freight Trust Network","chainId":211,"shortName":"EDI","chain":"EDI","network":"freight & trade network","networkId":0,"nativeCurrency":{"name":"Freight Trust Native","symbol":"0xF","decimals":18},"rpc":["http://13.57.207.168:3435","https://app.freighttrust.net/ftn/${API_KEY}"],"faucets":["http://faucet.freight.sh"],"infoURL":"https://freighttrust.com"},{"name":"Webchain","chainId":24484,"shortName":"web","chain":"WEB","network":"mainnet","networkId":37129,"nativeCurrency":{"name":"Webchain Ether","symbol":"WEB","decimals":18},"rpc":["https://node1.webchain.network"],"faucets":[],"infoURL":"https://webchain.network"},{"name":"ARTIS sigma1","chainId":246529,"shortName":"ats","chain":"ARTIS","network":"sigma1","networkId":246529,"nativeCurrency":{"name":"ARTIS sigma1 Ether","symbol":"ATS","decimals":18},"rpc":["https://rpc.sigma1.artis.network"],"faucets":[],"infoURL":"https://artis.eco"},{"name":"ARTIS tau1","chainId":246785,"shortName":"ats","chain":"ARTIS","network":"tau1","networkId":246785,"nativeCurrency":{"name":"ARTIS tau1 Ether","symbol":"ATS","decimals":18},"rpc":["https://rpc.tau1.artis.network"],"faucets":[],"infoURL":"https://artis.network"},{"name":"Fantom Opera","chainId":250,"shortName":"ftm","chain":"FTM","network":"mainnet","networkId":250,"nativeCurrency":{"name":"Fantom","symbol":"FTM","decimals":18},"rpc":["https://rpc.fantom.network","https://fantomscan.io/rpc"],"faucets":[],"infoURL":"https://fantom.foundation"},{"name":"High Performance Blockchain","chainId":269,"shortName":"hpb","chain":"HPB","network":"mainnet","networkId":100,"nativeCurrency":{"name":"High Performance Blockchain Ether","symbol":"HPB","decimals":18},"rpc":["https://node.hpb.blue"],"faucets":[],"infoURL":"https://hpb.io"},{"name":"Auxilium Network Mainnet","chainId":28945486,"shortName":"aux","chain":"AUX","network":"mainnet","networkId":28945486,"nativeCurrency":{"name":"Auxilium coin","symbol":"AUX","decimals":18},"rpc":["https://rpc.auxilium.global"],"faucets":[],"infoURL":"https://auxilium.global"},{"name":"Ethereum Testnet Ropsten","chainId":3,"shortName":"rop","chain":"ETH","network":"ropsten","networkId":3,"nativeCurrency":{"name":"Ropsten Ether","symbol":"ROP","decimals":18},"rpc":["https://ropsten.infura.io/v3/${INFURA_API_KEY}"],"faucets":["https://faucet.ropsten.be?${ADDRESS}"],"infoURL":"https://github.com/ethereum/ropsten"},{"name":"RSK Mainnet","chainId":30,"shortName":"rsk","chain":"RSK","network":"mainnet","networkId":30,"nativeCurrency":{"name":"RSK Mainnet Ether","symbol":"RSK","decimals":18},"rpc":["https://public-node.rsk.co","https://mycrypto.rsk.co"],"faucets":[],"infoURL":"https://rsk.co"},{"name":"RSK Testnet","chainId":31,"shortName":"trsk","chain":"RSK","network":"testnet","networkId":31,"nativeCurrency":{"name":"RSK Testnet Ether","symbol":"TRSK","decimals":18},"rpc":["https://public-node.testnet.rsk.co","https://mycrypto.testnet.rsk.co"],"faucets":["https://faucet.testnet.rsk.co"],"infoURL":"https://rsk.co"},{"name":"Ethersocial Network","chainId":31102,"shortName":"esn","chain":"ESN","network":"mainnet","networkId":1,"nativeCurrency":{"name":"Ethersocial Network Ether","symbol":"ESN","decimals":18},"rpc":["https://api.esn.gonspool.com"],"faucets":[],"infoURL":"https://ethersocial.org"},{"name":"Pirl","chainId":3125659152,"shortName":"pirl","chain":"PIRL","network":"mainnet","networkId":3125659152,"nativeCurrency":{"name":"Pirl Ether","symbol":"PIRL","decimals":18},"rpc":["https://wallrpc.pirl.io"],"faucets":[],"infoURL":"https://pirl.io"},{"name":"Valorbit","chainId":38,"shortName":"val","chain":"VAL","network":"mainnet","networkId":38,"nativeCurrency":{"name":"Valorbit","symbol":"VAL","decimals":18},"rpc":["https://rpc.valorbit.com/v2"],"faucets":[],"infoURL":"https://valorbit.com"},{"name":"Lisinski","chainId":385,"shortName":"lisinski","chain":"CRO","network":"mainnet","networkId":385,"nativeCurrency":{"name":"Lisinski Ether","symbol":"LISINSKI","decimals":18},"rpc":["https://rpc-bitfalls1.lisinski.online"],"faucets":["https://pipa.lisinski.online"],"infoURL":"https://lisinski.online"},{"name":"Energi Mainnet","chainId":39797,"shortName":"nrg","chain":"NRG","network":"mainnet","networkId":39797,"nativeCurrency":{"name":"Energi","symbol":"NRG","decimals":18},"rpc":["https://nodeapi.gen3.energi.network"],"faucets":[],"infoURL":"https://www.energi.world/"},{"name":"Ethereum Testnet Rinkeby","chainId":4,"shortName":"rin","chain":"ETH","network":"rinkeby","networkId":4,"nativeCurrency":{"name":"Rinkeby Ether","symbol":"RIN","decimals":18},"rpc":["https://rinkeby.infura.io/v3/${INFURA_API_KEY}"],"faucets":["https://faucet.rinkeby.io"],"infoURL":"https://www.rinkeby.io"},{"name":"Ethereum Testnet Kovan","chainId":42,"shortName":"kov","chain":"ETH","network":"kovan","networkId":42,"nativeCurrency":{"name":"Kovan Ether","symbol":"KOV","decimals":18},"rpc":["https://kovan.infura.io/v3/${INFURA_API_KEY}"],"faucets":["https://faucet.kovan.network","https://gitter.im/kovan-testnet/faucet"],"infoURL":"https://kovan-testnet.github.io/website"},{"name":"Athereum","chainId":43110,"shortName":"ath","chain":"ATH","network":"athereum","networkId":43110,"nativeCurrency":{"name":"Athereum Ether","symbol":"ATH","decimals":18},"rpc":["https://ava.network:21015/ext/evm/rpc"],"faucets":["http://athfaucet.ava.network//?address=${ADDRESS}"],"infoURL":"https://athereum.ava.network"},{"name":"Energi Testnet","chainId":49797,"shortName":"tnrg","chain":"NRG","network":"testnet","networkId":49797,"nativeCurrency":{"name":"Energi","symbol":"tNRG","decimals":18},"rpc":["https://nodeapi.test3.energi.network"],"faucets":[],"infoURL":"https://www.energi.world/"},{"name":"Ethereum Testnet GÃ¶rli","chainId":5,"shortName":"gor","chain":"ETH","network":"goerli","networkId":5,"nativeCurrency":{"name":"GÃ¶rli Ether","symbol":"GOR","decimals":18},"rpc":["https://rpc.goerli.mudit.blog/","https://rpc.slock.it/goerli ","https://goerli.prylabs.net/"],"faucets":["https://goerli-faucet.slock.it/?address=${ADDRESS}","https://faucet.goerli.mudit.blog"],"infoURL":"https://goerli.net/#about"},{"name":"Binance Smart Chain Mainnet","chainId":56,"shortName":"bnb","chain":"BSC","network":"mainnet","networkId":56,"nativeCurrency":{"name":"Binance Chain Native Token","symbol":"BNB","decimals":18},"rpc":["https://bsc-dataseed1.binance.org","https://bsc-dataseed2.binance.org","https://bsc-dataseed3.binance.org","https://bsc-dataseed4.binance.org","https://bsc-dataseed1.defibit.io","https://bsc-dataseed2.defibit.io","https://bsc-dataseed3.defibit.io","https://bsc-dataseed4.defibit.io","https://bsc-dataseed1.ninicoin.io","https://bsc-dataseed2.ninicoin.io","https://bsc-dataseed3.ninicoin.io","https://bsc-dataseed4.ninicoin.io"],"faucets":[],"infoURL":"https://www.binance.org"},{"name":"Ethereum Classic Testnet Kotti","chainId":6,"shortName":"kot","chain":"ETC","network":"kotti","networkId":6,"nativeCurrency":{"name":"Kotti Ether","symbol":"KOT","decimals":18},"rpc":[],"faucets":[],"infoURL":"https://explorer.jade.builders/?network=kotti"},{"name":"GoChain","chainId":60,"shortName":"go","chain":"GO","network":"mainnet","networkId":60,"nativeCurrency":{"name":"GoChain Ether","symbol":"GO","decimals":18},"rpc":["https://rpc.gochain.io"],"faucets":[],"infoURL":"https://gochain.io"},{"name":"Ethereum Classic Mainnet","chainId":61,"shortName":"etc","chain":"ETC","network":"mainnet","networkId":1,"nativeCurrency":{"name":"Ethereum Classic Ether","symbol":"ETC","decimals":18},"rpc":["https://ethereumclassic.network"],"faucets":[],"infoURL":"https://ethereumclassic.org"},{"name":"Aquachain","chainId":61717561,"shortName":"aqua","chain":"AQUA","network":"mainnet","networkId":61717561,"nativeCurrency":{"name":"Aquachain Ether","symbol":"AQUA","decimals":18},"rpc":["https://c.onical.org","https://tx.aquacha.in/api"],"faucets":["https://aquacha.in/faucet"],"infoURL":"https://aquachain.github.io"},{"name":"Ethereum Classic Testnet Morden","chainId":62,"shortName":"tetc","chain":"ETC","network":"testnet","networkId":2,"nativeCurrency":{"name":"Ethereum Classic Testnet Ether","symbol":"TETC","decimals":18},"rpc":[],"faucets":[],"infoURL":"https://ethereumclassic.org"},{"name":"Ethereum Classic Testnet Mordor","chainId":63,"shortName":"metc","chain":"ETC","network":"testnet","networkId":7,"nativeCurrency":{"name":"Mordor Classic Testnet Ether","symbol":"METC","decimals":18},"rpc":[],"faucets":[],"infoURL":"https://github.com/eth-classic/mordor/"},{"name":"Ellaism","chainId":64,"shortName":"ella","chain":"ELLA","network":"mainnet","networkId":64,"nativeCurrency":{"name":"Ellaism Ether","symbol":"ELLA","decimals":18},"rpc":["https://jsonrpc.ellaism.org"],"faucets":[],"infoURL":"https://ellaism.org"},{"name":"ThaiChain","chainId":7,"shortName":"tch","chain":"TCH","network":"mainnet","networkId":7,"nativeCurrency":{"name":"ThaiChain Ether","symbol":"TCH","decimals":18},"rpc":["https://rpc.dome.cloud"],"faucets":[],"infoURL":"https://thaichain.io"},{"name":"Mix","chainId":76,"shortName":"mix","chain":"MIX","network":"mainnet","networkId":76,"nativeCurrency":{"name":"Mix Ether","symbol":"MIX","decimals":18},"rpc":["https://rpc2.mix-blockchain.org:8647"],"faucets":[],"infoURL":"https://mix-blockchain.org"},{"name":"POA Network Sokol","chainId":77,"shortName":"poa","chain":"POA","network":"sokol","networkId":77,"nativeCurrency":{"name":"POA Sokol Ether","symbol":"POA","decimals":18},"rpc":["https://sokol.poa.network"],"faucets":["https://faucet-sokol.herokuapp.com"],"infoURL":"https://poa.network"},{"name":"Musicoin","chainId":7762959,"shortName":"music","chain":"MUSIC","network":"mainnet","networkId":7762959,"nativeCurrency":{"name":"Musicoin","symbol":"MUSIC","decimals":18},"rpc":["https://mewapi.musicoin.tw"],"faucets":[],"infoURL":"https://musicoin.tw"},{"name":"Firenze test network","chainId":78110,"shortName":"firenze","chain":"ETH","network":"testnet","networkId":78110,"nativeCurrency":{"name":"Firenze Ether","symbol":"FIN","decimals":18},"rpc":["https://ethnode.primusmoney.com/firenze"],"faucets":[],"infoURL":"https://primusmoney.com"},{"name":"Ubiq Network Mainnet","chainId":8,"shortName":"ubq","chain":"UBQ","network":"mainnet","networkId":88,"nativeCurrency":{"name":"Ubiq Ether","symbol":"UBQ","decimals":18},"rpc":["https://rpc.octano.dev","https://pyrus2.ubiqscan.io"],"faucets":[],"infoURL":"https://ubiqsmart.com"},{"name":"Matic Mumbai","chainId":80001,"shortName":"matic","chain":"Matic","network":"testnet","networkId":80001,"nativeCurrency":{"name":"Matic","symbol":"MATIC","decimals":18},"rpc":["https://rpc-mumbai.matic.today","wss://ws-mumbai.matic.today"],"faucets":["https://faucet.matic.network/"],"infoURL":"https://matic.network/"},{"name":"Callisto Mainnet","chainId":820,"shortName":"clo","chain":"CLO","network":"mainnet","networkId":1,"nativeCurrency":{"name":"Callisto Mainnet Ether","symbol":"CLO","decimals":18},"rpc":["https://clo-geth.0xinfra.com"],"faucets":[],"infoURL":"https://callisto.network"},{"name":"Callisto Testnet","chainId":821,"shortName":"tclo","chain":"CLO","network":"testnet","networkId":2,"nativeCurrency":{"name":"Callisto Testnet Ether","symbol":"TCLO","decimals":18},"rpc":[],"faucets":[],"infoURL":"https://callisto.network"},{"name":"TomoChain","chainId":88,"shortName":"tomo","chain":"TOMO","network":"mainnet","networkId":88,"nativeCurrency":{"name":"TomoChain Ether","symbol":"TOMO","decimals":18},"rpc":["https://core.tomocoin.io"],"faucets":[],"infoURL":"https://tomocoin.io"},{"name":"Ubiq Network Testnet","chainId":9,"shortName":"tubq","chain":"UBQ","network":"mainnet","networkId":2,"nativeCurrency":{"name":"Ubiq Testnet Ether","symbol":"TUBQ","decimals":18},"rpc":[],"faucets":[],"infoURL":"https://ethersocial.org"},{"name":"Binance Smart Chain Testnet","chainId":97,"shortName":"bnb","chain":"BSC","network":"Chapel","networkId":97,"nativeCurrency":{"name":"Binance Chain Native Token","symbol":"BNB","decimals":18},"rpc":["https://data-seed-prebsc-1-s1.binance.org:8545","https://data-seed-prebsc-2-s1.binance.org:8545","http://data-seed-prebsc-1-s2.binance.org:8545","http://data-seed-prebsc-2-s2.binance.org:8545","https://data-seed-prebsc-1-s3.binance.org:8545","https://data-seed-prebsc-2-s3.binance.org:8545"],"faucets":["https://testnet.binance.org/faucet-smart"],"infoURL":"https://testnet.binance.org/"},{"name":"Nepal Blockchain Network","chainId":977,"shortName":"yeti","chain":"YETI","network":"mainnet","networkId":977,"nativeCurrency":{"name":"Nepal Blockchain Network Ether","symbol":"YETI","decimals":18},"rpc":["https://api.nepalblockchain.dev","https://api.nepalblockchain.network"],"faucets":["https://faucet.nepalblockchain.network"],"infoURL":"https://nepalblockchain.network"},{"name":"POA Network Core","chainId":99,"shortName":"skl","chain":"POA","network":"core","networkId":99,"nativeCurrency":{"name":"POA Network Core Ether","symbol":"SKL","decimals":18},"rpc":["https://core.poa.network"],"faucets":[],"infoURL":"https://poa.network"}];
	
	//particles
	var particles;
	
	//dashboard
	var topbarPortfolio,topbarHighestAPY,topbarSFI,topbarETH,topbarBTC;
	var btnConnectWallet,spanConnectWallet,iconConnectWallet;
	var btnConnected,spanConnected,btnsRefresh;
	var tblDashPoolExplorer,tblDashExpirationDates;
	var dashboardChart,dashboardGraphDays;
	//liquidity pools
	var btnPoolDepositDai,currentEpoch,secsUntilRemoval,cycleParams,epochEnd;
	var trancheSFIMultiplierS,trancheSFIMultiplierAA,trancheSFIMultiplierA;
	var tranchApyS,tranchApyAA,tranchApyA;
	//redeem pools
	var btnPoolRedeemDai,redeemTabNextRemovalWindow,redeemTabNextRemovalText,redeemTabNextRemovalTime,redeemTabProgressBar;
	//modals
	var modalPoolSliderRange,timerModalPoolSlider,modalPoolSliderOptions;
	
	var modalDepositAA,modalDepositA,modalDepositS,modalDepositDaiBalance,depositDaiBalance,modalDepositDaiAmount,depositDaiAmount,modalDepositDaiRedeemDate;
	var spanATrancheMultiplier,btnAddLiquidity,btnCancelAddLiquidity,btnCancelAddLiquidity2;
	
	var modalRedeemAA,modalRedeemA,modalRedeemS;
	var modalRedeemPrincipalBalance,redeemPrincipalBalance,modalRedeemPrincipalAmount,modalRedeemPrincipalAmount,modalRedeemInterestBalance,redeemInterestBalance,modalRedeemInterestAmount,modalRedeemSFIBalance,redeemSFIBalance,modalRedeemSFIAmount;
	var redeemDsecBalance,redeemDsecTotal,redeemInterest,redeemSFI;
	var spanATrancheMultiplierRedeem,btnRemoveLiquidity,btnCancelRemoveLiquidity,btnCancelRemoveLiquidity2;
	
	var hHighestYieldAvailable,hTotalSupplySFI;
	var hDaiAdapterSHighestAPY,hDaiAdapterAAHighestAPY,hDaiAdapterAHighestAPY,hDaiAdapterAPY,hDaiAdapterMultiplier;
	var hPortfolioPrincipalTokens,hInterestEarned,hSfiTokensEarned;
	var hPortfolioPrincipalTokensAll,hInterestEarnedAll,hSfiTokensEarnedAll;
	var hPortfolioPrincipalTokensDAI,hInterestEarnedDAI,hSfiTokensEarnedDAI;
	var hTotalLiquidity,hSfiTokensOwned,modalRedeemWhat;
	var hPortfolioValue,hPortfolioEarnings,hInterestEstimated,hSfiTokensEstimated;
	var historyLoading;
	
	var updatableFields=[
//		"hHighestYieldAvailable","hTotalSupplySFI",
		"topbarPortfolio","topbarHighestAPY","topbarSFI","topbarETH","topbarBTC",
		"hPortfolioPrincipalTokens","hInterestEarned","hSfiTokensEarned",
		"hPortfolioPrincipalTokensAll","hInterestEarnedAll","hSfiTokensEarnedAll",
		"hPortfolioPrincipalTokensDAI","hInterestEarnedDAI","hSfiTokensEarnedDAI",
		"hTotalLiquidity","hSfiTokensOwned",
		"hPortfolioValue","hPortfolioEarnings","hInterestEstimated","hSfiTokensEstimated",
		"hDaiAdapterSHighestAPY","hDaiAdapterAAHighestAPY","hDaiAdapterAHighestAPY","hDaiAdapterAPY","hDaiAdapterMultiplier",
		"redeemTabNextRemovalWindow","redeemTabNextRemovalTime",
		"trancheSFIMultiplierS","trancheSFIMultiplierAA","trancheSFIMultiplierA",
		"tranchApyS","tranchApyAA","tranchApyA"
	];
	
	// governance
	var addressGovernance;
	
	// âœ“ Deployed instance of SaffronPool
	var contractSaffronPool;
	var addressSaffronPool={
		"kov":"0x898932Fd99355953DC46cb6Aa47F76a183ACb381",
		"eth":"0xDC41BBB87200D4e28A244e008CFE39a459A87FDe"
	};
	var abiSaffronPool=[{"inputs":[{"internalType":"address","name":"_strategy","type":"address"},{"internalType":"address","name":"_base_asset","type":"address"},{"internalType":"uint256","name":"_precision","type":"uint256"},{"internalType":"address","name":"_SFI_address","type":"address"},{"internalType":"address","name":"_team_address","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"new_pool_principal","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"new_epoch_principal","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"new_eternal_balance","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"new_tranche_principal","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"new_tranche_dsec","type":"uint256"}],"name":"AddLiquidity","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"time_remaining","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"dsec","type":"uint256"},{"indexed":false,"internalType":"address","name":"dsec_address","type":"address"},{"indexed":false,"internalType":"uint256","name":"epoch","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"tranche","type":"uint256"},{"indexed":false,"internalType":"address","name":"user_address","type":"address"},{"indexed":false,"internalType":"address","name":"principal_token_addr","type":"address"}],"name":"DsecGeneration","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"who","type":"address"},{"indexed":false,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"address","name":"token","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"ErcSwept","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"dsec_percent","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"interest_owned","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"SFI_owned","type":"uint256"}],"name":"RemoveLiquidityDsec","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"principal","type":"uint256"}],"name":"RemoveLiquidityPrincipal","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"adapter_address","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"epoch","type":"uint256"}],"name":"StrategicDeploy","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"adapter_holdings","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"adapter_total_principal","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"epoch_interest_rate","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"epoch_principal","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"epoch_interest","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"tranche_A_interest","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"tranche_AA_interest","type":"uint256"}],"name":"WindDownEpochInterest","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"previous_epoch","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"S_SFI","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"AA_SFI","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"A_SFI","type":"uint256"}],"name":"WindDownEpochSFI","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"epoch","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"tranche_S_interest","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"tranche_AA_interest","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"tranche_A_interest","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"tranche_SFI_earnings_S","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"tranche_SFI_earnings_AA","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"tranche_SFI_earnings_A","type":"uint256"}],"name":"WindDownEpochState","type":"event"},{"inputs":[],"name":"SFI_address","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"TRANCHE_SFI_MULTIPLIER","outputs":[{"internalType":"uint256","name":"S","type":"uint256"},{"internalType":"uint256","name":"AA","type":"uint256"},{"internalType":"uint256","name":"A","type":"uint256"},{"internalType":"uint256","name":"SAA","type":"uint256"},{"internalType":"uint256","name":"SA","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"_shutdown","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"adapter_total_principal","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"base_asset_address","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"best_adapter_address","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"divisor","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"dsec_token_addresses","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"epoch_cycle","outputs":[{"internalType":"uint256","name":"start_date","type":"uint256"},{"internalType":"uint256","name":"duration","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"epoch_principal","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"epoch_wound_down","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"governance","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"pool_interest","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"pool_principal","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"principal_token_addresses","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"team_address","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"tranche_A_multiplier","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"tranche_SFI_earned","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"tranche_interest_earned","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"tranche_total_dsec","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"tranche_total_principal","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"tranche_total_vdsec_A","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"tranche_total_vdsec_AA","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"uint256","name":"epoch","type":"uint256"},{"internalType":"address[]","name":"saffron_v1_dsec_token_addresses","type":"address[]"},{"internalType":"address[]","name":"saffron_v1_principal_token_addresses","type":"address[]"}],"name":"new_epoch","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"enum ISaffronBase.Tranche","name":"tranche","type":"uint8"}],"name":"add_liquidity","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"epoch","type":"uint256"}],"name":"wind_down_epoch","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"v1_dsec_token_address","type":"address"},{"internalType":"uint256","name":"dsec_amount","type":"uint256"},{"internalType":"address","name":"v1_principal_token_address","type":"address"},{"internalType":"uint256","name":"principal_amount","type":"uint256"}],"name":"remove_liquidity","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"adapter_address","type":"address"}],"name":"hourly_strategy","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"shutdown","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"}],"name":"set_governance","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"epoch","type":"uint256"}],"name":"get_epoch_end","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"get_current_epoch","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"uint256","name":"epoch","type":"uint256"}],"name":"get_seconds_until_epoch_end","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"get_epoch_cycle_params","outputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"get_base_asset_address","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"get_governance","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"get_strategy_address","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"delete_adapters","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_token","type":"address"},{"internalType":"address","name":"_to","type":"address"}],"name":"erc_sweep","outputs":[],"stateMutability":"nonpayable","type":"function"}];

	var contractStrategy;
	var addressStrategy;
	var abiStrategy=[{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"governance","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"address","name":"base_asset_address","type":"address"}],"name":"select_best_adapter","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"deploy_all_capital","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"adapter_address","type":"address"}],"name":"add_adapter","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"adapter_address","type":"address"}],"name":"get_adapter_index","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"uint256","name":"index","type":"uint256"}],"name":"get_adapter_address","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"address","name":"pool_address","type":"address"}],"name":"add_pool","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"delete_adapters","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"}],"name":"set_governance","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"select_adapter_for_liquidity_removal","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"nonpayable","type":"function"}];

	var contractCErc20DAI;
	var addressCErc20DAI={
		"kov":"0xf0d0eb522cfa50b716b3b1604c4f0fa6f04376ad",
		"eth":"0x5d3a536e4d6dbd6114cc1ead35777bab948e3643"
	};
	var abiCErc20DAI=[{"inputs":[],"name":"exchangeRateCurrent","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"mint","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"redeem","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"redeemUnderlying","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"supplyRatePerBlock","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"}];

	// âœ“ Deployed instance of DAI_Compound_Adapter
	var contractDAICompoundAdapter;
	var addressDAICompoundAdapter;
	var abiDAICompoundAdapter=[{"inputs":[{"internalType":"address","name":"_saffron_pool","type":"address"},{"internalType":"address","name":"CErc20_contract_address","type":"address"},{"internalType":"address","name":"base_asset_address","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"who","type":"address"},{"indexed":false,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"address","name":"token","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"ErcSwept","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"","type":"uint256"}],"name":"GetExchangeRate","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"cdai_balance","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"base_asset_amount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"ctokens_redeemed","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"exchange_rate","type":"uint256"}],"name":"ReturnCapital","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"who","type":"address"},{"indexed":false,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"cBal","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"dBal","type":"uint256"}],"name":"Swept","type":"event"},{"inputs":[],"name":"created","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"governance","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"platform","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"saffron_pool","outputs":[{"internalType":"contract ISaffronPool","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"deploy_capital","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"base_asset_amount","type":"uint256"},{"internalType":"address","name":"to","type":"address"}],"name":"return_capital","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_to","type":"address"}],"name":"sweep","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_token","type":"address"},{"internalType":"address","name":"_to","type":"address"}],"name":"erc_sweep","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"get_exchange_rate","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"get_holdings","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"principal","type":"uint256"}],"name":"get_interest","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"addr","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"approve_transfer","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"get_base_asset_address","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"get_ctoken_balance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"address","name":"addr","type":"address"}],"name":"set_base_asset","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"}],"name":"set_governance","outputs":[],"stateMutability":"nonpayable","type":"function"}];

	// DAI
	var contractDAI;
	var addressDAI;
	var abiDAI=[{"inputs":[{"internalType":"string","name":"name","type":"string"},{"internalType":"string","name":"symbol","type":"string"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Transfer","type":"event"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"spender","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"decimals","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"subtractedValue","type":"uint256"}],"name":"decreaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"addedValue","type":"uint256"}],"name":"increaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"mint","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"sender","type":"address"},{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transferFrom","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"}];

	// Saffron V1 Balance Tokens (principal and dsec)
	var contractsSaffronV1PrincipalTokens=[],contractsSaffronV1DsecTokens=[];
	var addressSaffronV1PrincipalToken,addressSaffronV1DsecToken;
	var abiSaffronV1BalanceToken=[{"inputs":[{"internalType":"string","name":"name","type":"string"},{"internalType":"string","name":"symbol","type":"string"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Transfer","type":"event"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"spender","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"decimals","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"subtractedValue","type":"uint256"}],"name":"decreaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"addedValue","type":"uint256"}],"name":"increaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"pool_address","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"sender","type":"address"},{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transferFrom","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"mint","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"burn","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"}],"name":"set_governance","outputs":[],"stateMutability":"nonpayable","type":"function"}];

	// SFI
	var contractSFI;
	var addressSFI;
	var abiSFI=[{"inputs":[{"internalType":"string","name":"name","type":"string"},{"internalType":"string","name":"symbol","type":"string"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Transfer","type":"event"},{"inputs":[],"name":"MAX_TOKENS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"SFI_minter","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"spender","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"decimals","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"subtractedValue","type":"uint256"}],"name":"decreaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"governance","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"addedValue","type":"uint256"}],"name":"increaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"sender","type":"address"},{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transferFrom","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"mint_SFI","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"}],"name":"set_minter","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"}],"name":"set_governance","outputs":[],"stateMutability":"nonpayable","type":"function"}];
	
	function updateMenuTabs(hash) {
	    var a = window.location;
	    console.log("updateMenuTabs();",a.href);
	    var anchors = document.querySelectorAll(".vertical-menu a, .logobar a");
	    for (var i=0;i<anchors.length;i++) {
	    	if(anchors[i].href==a.href) {
	    		anchors[i].classList.add("active");
	    		anchors[i].parentElement.classList.add("active");
	    	} else {
	    		anchors[i].classList.remove("active");
	    		anchors[i].parentElement.classList.remove("active");
	    	}
	    }

		initParticles();

	    //TODO: only connect if requested, and use local storage to remember last connection type
		let needsWalletConnect=["#dashboard","#liquidity","#redeem"];
		if(!ethConnected && needsWalletConnect.includes(window.location.hash.toLowerCase())) connectWallet();
	}
	
	function initParticles() {
		//check if this is the home tab
		if(window.location.hash.toLowerCase()=="#home") {
			//is home tab so start particles if not started
			if(!particles) {
				//initialize particles
				var currencies=["dai","link","usdc","usdt","wbtc","yfi","sfi"];
				var tsImages=[];
				for(let currency of currencies) tsImages.push({"src":"assets/images/"+currency+".png","width":40,"height":40});
				console.log("tsImages:",tsImages);
				var tsConfig={"detectRetina":true,"fpsLimit":60,"interactivity":{"detectsOn":"canvas","events":{"resize":true},"modes":{"attract":{"distance":200,"duration":0.4,"speed":1},"bubble":{"distance":400,"duration":2,"opacity":0.8,"size":40},"connect":{"distance":80,"links":{"opacity":0.5},"radius":60},"grab":{"distance":400,"links":{"opacity":1}},"push":{"quantity":4},"remove":{"quantity":2},"repulse":{"distance":200,"duration":0.4,"speed":1},"slow":{"factor":3,"radius":200},"trail":{"delay":1,"quantity":1}}},"particles":{"move":{"angle":90,"attract":{"enable":false,"rotate":{"x":600,"y":1200}},"direction":"right","enable":true,"noise":{"delay":{"random":{"enable":false,"minimumValue":0},"value":0},"enable":false},"outMode":"out","random":false,"speed":2,"straight":false,"trail":{"enable":false,"length":10,"fillColor":{"value":"#000000"}}},"number":{"density":{"enable":true,"area":800,"factor":1600},"limit":0,"value":10},"opacity":{"animation":{"enable":false,"minimumValue":0.2,"speed":1,"sync":false},"random":{"enable":true,"minimumValue":1},"value":1},"rotate":{"animation":{"enable":true,"speed":5,"sync":false},"direction":"random","path":false,"random":true,"value":0},"shape":{"options":{"image":tsImages,"images":tsImages},"type":"image"},"size":{"value":16}},"pauseOnBlur":true};
		
				tsParticles.load("tsparticles",tsConfig);
		 		particles=tsParticles.domItem(0);
			} else {
				//particles paused so just play
				particles.play();
			}
		} else {
			//not home tab so check if particles yet, return if never initialized
			if(!particles) return;
			//particles are running, so pause them
			particles.pause();
		}
	}
	
	function init() {
		//set rounding modes of big numbers to truncate to floor, no rounding
		//https://mikemcl.github.io/bignumber.js/#decimal-places
		BigNumber.set({ ROUNDING_MODE: BigNumber.ROUND_FLOOR });
		
		//initialize html element vars
		topbarPortfolio=document.getElementById("topbarPortfolio");
		topbarHighestAPY=document.getElementById("topbarHighestAPY");
		topbarSFI=document.getElementById("topbarSFI");
		topbarETH=document.getElementById("topbarETH");
		topbarBTC=document.getElementById("topbarBTC");
		
		btnConnectWallet=document.getElementById("btnConnectWallet");
		spanConnectWallet=document.getElementById("spanConnectWallet");
		iconConnectWallet=document.getElementById("iconConnectWallet");
		btnConnected=document.getElementById("btnConnected");
		spanConnected=document.getElementById("spanConnected");
// 		hTotalSupplySFI=document.getElementById("hTotalSupplySFI");
// 		hHighestYieldAvailable=document.getElementById("hHighestYieldAvailable");
		
		hPortfolioPrincipalTokens=document.getElementById("hPortfolioPrincipalTokens");		
		hInterestEarned=document.getElementById("hInterestEarned");
		hSfiTokensEarned=document.getElementById("hSfiTokensEarned");
		
		hPortfolioValue=document.getElementById("hPortfolioValue");		
		hPortfolioEarnings=document.getElementById("hPortfolioEarnings");		
		hInterestEstimated=document.getElementById("hInterestEstimated");		
		hSfiTokensEstimated=document.getElementById("hSfiTokensEstimated");		

		hPortfolioPrincipalTokensAll=document.getElementById("hPortfolioPrincipalTokensAll");		
		hInterestEarnedAll=document.getElementById("hInterestEarnedAll");
		hSfiTokensEarnedAll=document.getElementById("hSfiTokensEarnedAll");
		
		hPortfolioPrincipalTokensDAI=document.getElementById("hPortfolioPrincipalTokensDAI");		
		hInterestEarnedDAI=document.getElementById("hInterestEarnedDAI");
		hSfiTokensEarnedDAI=document.getElementById("hSfiTokensEarnedDAI");
		hDaiAdapterSHighestAPY=document.getElementById("hDaiAdapterSHighestAPY");
		hDaiAdapterAAHighestAPY=document.getElementById("hDaiAdapterAAHighestAPY");
		hDaiAdapterAHighestAPY=document.getElementById("hDaiAdapterAHighestAPY");
		hDaiAdapterAPY=document.getElementById("hDaiAdapterAPY");
		hDaiAdapterMultiplier=document.getElementById("hDaiAdapterMultiplier");
		hSfiTokensOwned=document.getElementById("hSfiTokensOwned");
		
		tblDashPoolExplorer=document.getElementById("tblDashPoolExplorer");		
		tblDashExpirationDates=document.getElementById("tblDashExpirationDates");
		hTotalLiquidity=document.getElementById("hTotalLiquidity");
		dashboardGraphDays=document.getElementById("dashboardGraphDays");
		btnPoolDepositDai=document.getElementById("btnPoolDepositDai");
		modalDepositAA=document.getElementById("modalDepositAA");
		modalDepositA=document.getElementById("modalDepositA");
		modalDepositS=document.getElementById("modalDepositS");
		trancheSFIMultiplierS=document.getElementById("trancheSFIMultiplierS");
		trancheSFIMultiplierAA=document.getElementById("trancheSFIMultiplierAA");
		trancheSFIMultiplierA=document.getElementById("trancheSFIMultiplierA");
		tranchApyS=document.getElementById("tranchApyS");
		tranchApyAA=document.getElementById("tranchApyAA");
		tranchApyA=document.getElementById("tranchApyA");	
		spanATrancheMultiplier=document.getElementById("spanATrancheMultiplier");
		btnAddLiquidity=document.getElementById("btnAddLiquidity");
		btnCancelAddLiquidity=document.getElementById("btnCancelAddLiquidity");
		btnCancelAddLiquidity2=document.getElementById("btnCancelAddLiquidity2");
		btnPoolRedeemDai=document.getElementById("btnPoolRedeemDai");
		redeemTabNextRemovalWindow=document.getElementById("redeemTabNextRemovalWindow");
		redeemTabNextRemovalText=document.getElementById("redeemTabNextRemovalText");
		redeemTabNextRemovalTime=document.getElementById("redeemTabNextRemovalTime");
		redeemTabProgressBar=document.getElementById("redeemTabProgressBar");
		historyLoading=document.getElementById("historyLoading");
		
		modalDepositDaiBalance=document.getElementById("modalDepositDaiBalance");
		modalDepositDaiAmount=document.getElementById("modalDepositDaiAmount");
		modalRedeemAA=document.getElementById("modalRedeemAA");
		modalRedeemA=document.getElementById("modalRedeemA");
		modalRedeemS=document.getElementById("modalRedeemS");
		modalDepositDaiRedeemDate=document.getElementById("modalDepositDaiRedeemDate");
		
		modalRedeemPrincipalBalance=document.getElementById("modalRedeemPrincipalBalance");
		modalRedeemPrincipalAmount=document.getElementById("modalRedeemPrincipalAmount");
		modalRedeemInterestBalance=document.getElementById("modalRedeemInterestBalance");
		modalRedeemInterestAmount=document.getElementById("modalRedeemInterestAmount");
		modalRedeemSFIBalance=document.getElementById("modalRedeemSFIBalance");
		modalRedeemSFIAmount=document.getElementById("modalRedeemSFIAmount");
		
		spanATrancheMultiplierRedeem=document.getElementById("spanATrancheMultiplierRedeem");
		btnRemoveLiquidity=document.getElementById("btnRemoveLiquidity");
		btnCancelRemoveLiquidity=document.getElementById("btnCancelRemoveLiquidity");
		btnCancelRemoveLiquidity2=document.getElementById("btnCancelRemoveLiquidity2");
		
		//connect links/buttons
		btnConnectWallet.addEventListener("click",connectWallet);
		btnConnected.addEventListener("click",connectWallet);
		dashboardGraphDays.addEventListener("change",updateDashboardChart);
		btnPoolDepositDai.addEventListener("click",showDepositDaiModal);
		btnAddLiquidity.addEventListener("click",addLiquidity);
		btnPoolRedeemDai.addEventListener("click",showRedeemDaiModal);
		btnRemoveLiquidity.addEventListener("click",removeLiquidity);
		
		//dismiss popovers
		$('.popover-dismiss').popover({
			  trigger: 'focus'
		});
		
		//keep ratio of redemption amounts equal to dsec being withdrawn
		modalRedeemInterestAmount.addEventListener("input",()=>{
			
			let amount=new BigNumber(modalRedeemInterestAmount.value);
			if(isNaN(amount)) amount=new BigNumber(0);
			console.log("interest udpating:",amount.toString(),"redeemInterestBalance:",redeemInterestBalance.toString());
			
			//calculate dsec percentage
			let dsecPercentage=amount.times(new BigNumber("1e18")).div(redeemInterestBalance);
			console.log("interest udpating:",amount.toString(),"redeemInterestBalance:",redeemInterestBalance.toString(),"dsecPercentage:",dsecPercentage.toString());
			
			//set amounts on redeem modal
			modalRedeemSFIAmount.value=dsecPercentage.times(redeemSFIBalance).div(new BigNumber("1e18")).toFixed(8);
		});

		modalRedeemSFIAmount.addEventListener("input",()=>{
			let amount=new BigNumber(modalRedeemSFIAmount.value);
			if(isNaN(amount)) amount=new BigNumber(0);
			
			//calculate dsec percentage
			let dsecPercentage=amount.times(new BigNumber("1e18")).div(redeemSFIBalance);
			console.log("SFI udpating:",amount.toString(),"redeemSFIBalance:",redeemSFIBalance.toString(),"dsecPercentage:",dsecPercentage.toString());
			
			//set amounts on redeem modal
			modalRedeemInterestAmount.value=dsecPercentage.times(redeemInterestBalance).div(new BigNumber("1e18")).toFixed(8);
		});
		
		//connect refresh buttons
		btnsRefresh=document.getElementsByClassName("btn refresh");
		for(let i=0;i<btnsRefresh.length;i++) {
			btnsRefresh[i].addEventListener("click",updateBalances);
		}
		
		//connect redeem dai modal "what to redeem" radio
        let modalRedeemWhat=document.getElementsByName("modalRedeemWhat"); 
        for(let what of modalRedeemWhat) {
        	what.addEventListener("click",showHideRedeemCards);
        }
        //initialize collapse feature of the cards on the redeem pool modal
        $("#rowRedeemPrincipal").collapse();
        $("#rowRedeemInterestSFI").collapse();
        
        //connect redeem dai modal "tranche" radio
        let modalRedeemDaiTranches=document.getElementsByName("modalRedeemDaiTranches"); 
        for(let tranche of modalRedeemDaiTranches) {
        	tranche.addEventListener("click",updateRedeemDAIModal);
        }

	    /* ----- dashboard Apex Area Chart ----- */
	    // https://apexcharts.com/docs/methods/#updateOptions
	    var options = {
	        chart: {
	            height: 300,
	            type: 'area',
	            toolbar: {
	                show: false
	            },
	            zoom: {
	              type: 'x',
	              enabled: false,
	              autoScaleYaxis: true
	            },
	        },
	        dataLabels: {
	            enabled: false
	        },
	        stroke: {
	            curve: 'smooth',
	        },
	        colors: ['#C44536'], //, '#F7931B', '#59ac06', '#3333cc', '#9900cc' ],
	        series: [{
	            name: 'Pool Principal',
	            data: []
// 	        }, {
// 	            name: 'Epoch Principal',
// 	            data: []
// 	        }, {
// 	             name: 'Eternal Balance',
// 	             data: []
// 	         }, {
// 	             name: 'Tranche Principal',
// 	             data: []
// 	         }, {
// 	             name: 'Tranche DSEC',
// 	             data: []
	        }],
	        legend: {
	            show: false,
	        },
// 	        fill: {
// 	            opacity: .5,
// 	            type: "solid"
// 	        },
			//https://apexcharts.com/docs/options/yaxis/
			yaxis: {
				forceNiceScale: true,
				tickAmount: 5,
				min: 0,
				labels: {
					formatter: function(val, index) {
				        return "$"+(new BigNumber(val).toFormat(2));
					}
				}
			},
	        xaxis: {
	            type: 'datetime',
	            categories: [],
	            axisBorder: {
	                show: true, 
	                color: 'rgba(0,0,0,0.05)'
	            },
	            axisTicks: {
	                show: true, 
	                color: 'rgba(0,0,0,0.05)'
	            }
	        },
	        grid: {
	            row: {
	                colors: ['transparent'], //, 'transparent', 'transparent', 'transparent', 'transparent'], 
	                opacity: .2
	            },
	            borderColor: 'rgba(0,0,0,0.05)'
	        },
	        tooltip: {
	            x: {
	                format: 'yyyy-MM-dd HH:mm'
	            },
	        },
// 	        noData: {
// 	            text: 'Loading history...',
// 	            style: {
// 	            	color: "#C44536",
// 	            	fontSize: "20px"
// 	            }
// 	        }
	    }
	    dashboardChart=new ApexCharts(
	        document.querySelector("#dashboard-apex-area-chart"),
	        options
	    );
	    dashboardChart.render();	
	    
		//add amounts buttons
		document.querySelectorAll(".amountPercent").forEach(button=>{
			button.addEventListener("click",event=>{
				let froms=button.dataset.from.split(",");
				let tos=button.dataset.to.split(",");
				for(let i=0;i<froms.length;i++) {
					let from=window[froms[i]];  //is BigNumber already
					let to=window[tos[i]];
					console.log("from:",from,"to:",to);
					let eth=new BigNumber("1e18");
					let percent=new BigNumber(button.dataset.percent);
					to.value=from.times(percent).div(eth).toFixed(8);
				}
		  	});
		});
		
// 		//TODO: only connect if requested, and use local storage to remember last connection type
// 		let needsWalletConnect=["#dashboard","#liquidity","#redeem"];
// 		if(!ethConnected && needsWalletConnect.includes(window.location.hash.toLowerCase())) connectWallet();
		/* Automagically jump on good tab based on anchor; for page reloads or links */
		if(location.hash) {
			console.log("load "+location.hash);
			$('a[href="' + location.hash + '"]').tab('show');         
		} else {
			console.log("load #home");
			$('a[href="#home"]').tab('show');
		}
		$('a[data-toggle="tab"]').on('shown.bs.tab', function(e) {
			location.hash = $(e.target).attr('href').substr(1);
			console.log("shown.bs.tab",location.hash);
			scrollTo(0,0);     
			updateMenuTabs(location.hash);
		});
		$('a[data-toggle="tab"]').on('show.bs.tab', function(e) {
			console.log("show.bs.tab");
		});	
		$('a[data-toggle="tab"]').on('hide.bs.tab', function(e) {
			console.log("hide.bs.tab");
		});	
		$('a[data-toggle="tab"]').on('hidden.bs.tab', function(e) {
			console.log("hidden.bs.tab");
		});	
		/* Update hash based on tab, basically restores browser default behavior to fix bootstrap tabs */
		$(document.body).on("click", "a[data-toggle]", function(event) {
			location.hash = this.getAttribute("href");
		});
		/* on history back activate the tab of the location hash if exists or the default tab if no hash exists */   
		$(window).on('popstate', function() {
			//var anchor = location.hash || $("a[data-toggle=tab]").first().attr("href");
			var anchor = location.hash;
			$('a[href="' + anchor + '"]').tab('show');
		});   
		
	}
	
	function showHideRedeemCards(e) {
   		switch(e.target.value) {
   		case "0":
			$("#rowRedeemPrincipal").collapse("show");
			$("#rowRedeemInterestSFI").collapse("hide");	
   			break;
   		case "1":
			$("#rowRedeemPrincipal").collapse("hide");
			$("#rowRedeemInterestSFI").collapse("show");	
   			break;
   		case "2":
			$("#rowRedeemPrincipal").collapse("show");
			$("#rowRedeemInterestSFI").collapse("show");	
   			break;
   		}
		//clear invalid if there was one
		modalRedeemPrincipalAmount.classList.remove("is-invalid");
		modalRedeemInterestAmount.classList.remove("is-invalid");
		modalRedeemSFIAmount.classList.remove("is-invalid");
	}
	
	async function connectWeb3(){
		console.log("HHHHHHHH connectWeb3()");		
		//check for MetaMask
		if(typeof window.ethereum==="undefined") {
			//notify need to install MetaMask
			saffronAlert("Please install MetaMask: <a href='https:' target='_blank'>https://metamask.io/</a>","MetaMask Not Found!");
			return;
		}
		
		ethereum.on("accountsChanged",(accounts)=>{
			// Handle the new accounts, or lack thereof.
			// "accounts" will always be an array, but it can be empty.
			console.log("accounts:",JSON.stringify(accounts));
			//account[0]
			console.log("ethereum.selectedAddress:",);
			currentAccount=ethereum.selectedAddress;

			//hide connect wallet button
			btnConnectWallet.classList.add("hide");
			//show address button
			spanConnected.textContent=currentAccount.substr(0,6)+"..."+currentAccount.substr(-4);
			btnConnected.classList.remove("hide");
			
			console.log("currentAccount:",currentAccount);
		
			console.log("Wallet is MetaMask:",ethereum.isMetaMask);
			console.log("Ethereum chainId:",ethereum.networkVersion);
			
			ethConnected=true;
			console.log("ethConnected:"+ethConnected);
			
			chainInfo=chainIds.find(chain=>chain.chainId==ethereum.networkVersion);
			console.log("chain name",chainInfo.name);
			currentAccount=ethereum.selectedAddress;
			
			updateContracts();
		});
		
		ethereum.on("chainChanged",(chainId)=>{
			// Handle the new chain.
			// Correctly handling chain changes can be complicated.
			// We recommend reloading the page unless you have a very good reason not to.
			window.location.reload();
		});
		
		// NEVER TRIGGERED FOR SOME REASON
		ethereum.on("connect",(info)=>{
			console.log("connect",JSON.stringify(info));
		});
		
		// NEVER TRIGGERED FOR SOME REASON
		ethereum.on("disconnect",(info)=>{
			console.log("disconnect",JSON.stringify(info));
			//hide connected button
			btnConnected.classList.add("hide");
			//show connect button
			btnConnectWallet.disabled=false;
			iconConnectWallet.classList.remove("hide");
			spanConnectWallet.classList.add("hide");
		});
		
		// disable connect wallet button and show spinner
		btnConnectWallet.disabled=true;
		iconConnectWallet.classList.add("hide");
		spanConnectWallet.classList.remove("hide");
		
		//new web3 instance
		window.web3=new Web3(window.ethereum);
		//try to connect to extension wallet
		conn=await window.ethereum.enable();

		//check if connection was successful
		console.log("ethereum.isConnected():",ethereum.isConnected());
			
		ethConnected=conn.length>0
		console.log("ethConnected:"+ethConnected);
		
		//if connected show account details and set currentAddress
		if(ethConnected) {
			chainInfo=chainIds.find(chain=>chain.chainId==ethereum.networkVersion);
			console.log("chain name",chainInfo.name);
// 			networkName.textContent=chainInfo.name;
			
// 			//if kovan show green, else red
// 			if(ethereum.networkVersion==42) {
// 				networkName.parentElement.classList.remove("red");
// 				networkName.parentElement.classList.add("green");
// 			} else {
// 				networkName.parentElement.classList.remove("green");
// 				networkName.parentElement.classList.add("red");
// 			}
			
			//currentAccount=conn[0];
			currentAccount=ethereum.selectedAddress;
// 			walletAddress.textContent=currentAccount;

			//update dashboard page
			await updateContracts();
			
			//hide connect wallet button
			btnConnectWallet.classList.add("hide");
			//show address button
			spanConnected.textContent=currentAccount.substr(0,6)+"..."+currentAccount.substr(-4);
			btnConnected.classList.remove("hide");
			
			console.log("currentAccount:",currentAccount);
		
			console.log("Wallet is MetaMask:",ethereum.isMetaMask);
			console.log("Ethereum chainId:",ethereum.networkVersion);
		} else {
			//hide connected button
			btnConnected.classList.add("hide");
			//show connect button
			btnConnectWallet.disabled=false;
			iconConnectWallet.classList.remove("hide");
			spanConnectWallet.classList.add("hide");
		}
	}
	
	async function updateContracts() {
		console.log("updateContracts()");

		if(!ethConnected) await connectWeb3();

		if(!currentAccount || currentAccount.length==0) return;
		
		if(ethereum.networkVersion!=42 && ethereum.networkVersion!=1) {
			saffronAlert("Please connect MetaMask to the Mainnet or Kovan test network!","Wrong Ethereum Network!");
			return;
		}

		//get pool contract
		contractSaffronPool=new web3.eth.Contract(abiSaffronPool,addressSaffronPool[chainInfo.shortName]);
		console.log("addressSaffronPool:",addressSaffronPool[chainInfo.shortName]);
		
		//get strategy address, update input, create strategy contract
		addressStrategy=await contractSaffronPool.methods.get_strategy_address().call().catch((e)=>{
			console.log(`Error getting Strategy address: ${e.message}`);
		});
		contractStrategy=new web3.eth.Contract(abiStrategy,addressStrategy);
		console.log("addressStrategy:",addressStrategy);
		
		//get base DAI address, update input, create strategy contract
		addressDAI=await contractSaffronPool.methods.get_base_asset_address().call().catch((e)=>{
			console.log(`Error getting base asset address: ${e.message}`);
		});
		contractDAI = new web3.eth.Contract(abiDAI,addressDAI);
		console.log("addressDAI:",addressDAI);
		
		//get SaffronV1BalanceToken addresses
		let types=["S","AA","A"];
		let currentEpoch=await contractSaffronPool.methods.get_current_epoch().call().catch((e)=>{
			console.log(`Error getting current epoch: ${e.message}`);
		});
		currentEpoch=Number(currentEpoch);
		console.log("currentEpoch:",currentEpoch);
		for(let epoch=0;epoch<=currentEpoch;epoch++) {
			for(let i=0;i<types.length;i++) {
							
				let type=types[i];
				console.log("principal_token_addresses epoch:",epoch,"tranche:",i);
				addressSaffronV1PrincipalToken=await contractSaffronPool.methods.principal_token_addresses(epoch,i).call().catch((e)=>{
					console.log(`Error getting principal_token_addresses: ${e.message}`);
			 	});
				console.log("addressSaffronV1PrincipalToken:",addressSaffronV1PrincipalToken);
				//if no new addresses then exit
				if(typeof addressSaffronV1PrincipalToken === "undefined") {
					//found zero address so quit both loops
					epoch=currentEpoch+1;
					break;
				}
				
				//if i==0 intitialize the contracts for this epoch first
				if(i==0) {
					contractsSaffronV1PrincipalTokens[epoch]={};
					contractsSaffronV1DsecTokens[epoch]={};
				}
				
				//save the contract for this token
				contractsSaffronV1PrincipalTokens[epoch][type] = new web3.eth.Contract(abiSaffronV1BalanceToken, addressSaffronV1PrincipalToken);
				
				//get address for dsec
				addressSaffronV1DsecToken=await contractSaffronPool.methods.dsec_token_addresses(epoch,i).call().catch((e)=>{
					console.log(`Error getting dsec_token_addresses: ${e.message}`);
			 	});
				contractsSaffronV1DsecTokens[epoch][type] = new web3.eth.Contract(abiSaffronV1BalanceToken, addressSaffronV1DsecToken);
			}
		}
		console.log("contractsSaffronV1PrincipalTokens:",contractsSaffronV1PrincipalTokens.length);
		console.log("contractsSaffronV1DsecTokens:",contractsSaffronV1DsecTokens.length);
		
		//get governance address
		addressGovernance=await contractSaffronPool.methods.get_governance().call().catch((e)=>{
			console.log(`Error addressGovernance address: ${e.message}`);
		});
		console.log("addressGovernance:",addressGovernance);
		
		//get dai_adapter address, update input, create dai adapter contract (TODO: adapter[0] for now)
		addressDAICompoundAdapter=await contractStrategy.methods.get_adapter_address(0).call().catch((e)=>{
			console.log(`Error getting best DAICompoundAdapter address: ${e.message}`);
		});
		contractDAICompoundAdapter = new web3.eth.Contract(abiDAICompoundAdapter, addressDAICompoundAdapter);
		console.log("addressDAICompoundAdapter:",addressDAICompoundAdapter);

		//set ctoken address
		console.log("addressCErc20DAI:",addressCErc20DAI[chainInfo.shortName]);
		contractCErc20DAI=new web3.eth.Contract(abiCErc20DAI,addressCErc20DAI[chainInfo.shortName]);

		//get base SFI address, update input, create strategy contract
		addressSFI=await contractSaffronPool.methods.SFI_address().call().catch((e)=>{
			console.log(`Error getting SFI address: ${e.message}`);
		});
		contractSFI = new web3.eth.Contract(abiSFI, addressSFI);
		console.log("addressSFI:",addressSFI);
	
	 	//update balances
 	 	await updateBalances();
// 		btnRefresh.classList.remove("loading","disabled");
// 		enableButtons();
	}
	
	async function updateBalances() {
		console.log("updateBalances()");
		if(!ethConnected) await connectWeb3();

		if(!currentAccount || currentAccount.length==0) return;
		
		if(ethereum.networkVersion!=42 && ethereum.networkVersion!=1) {
			saffronAlert("Please connect MetaMask to the Mainnet or Kovan test network!","Wrong Ethereum Network!");
			return;
		}	
		
		//show spinner, disable refresh buttons
		for(let i=0;i<btnsRefresh.length;i++) {
			btnsRefresh[i].firstElementChild.classList.add("fa-spin");
			btnsRefresh[i].disabled=true;
		}
		
		for(let field of updatableFields) {
			window[field].innerHTML='<i class="fa fa-refresh fa-spin fa-fw"></i>';
		}
		
		//inputSV1AADAI,inputSV1ADAI,inputAAPortfolioBalance,inputAAPortfolioUtilized
		let eth=new BigNumber("1e18");
		
		/**** start tasks to get data asynchronously ****/
		let tasks=[];
		
		let poolInterest;
		tasks.push(
		    async ()=>{
				//get pool interest
			 	poolInterest=await contractSaffronPool.methods.pool_interest().call().catch((e)=>{
			 		console.log(`Error pool_interest: ${e.message}`);
			 	});
				poolInterest=(new BigNumber(poolInterest)).div(eth);
		    }
		);
		
		let poolPrincipal;
		tasks.push(
		    async ()=>{
			 	//get pool principal
			 	poolPrincipal=await contractSaffronPool.methods.pool_principal().call().catch((e)=>{
			 		console.log(`Error pool_principal: ${e.message}`);
			 	});
			 	poolPrincipal=(new BigNumber(poolPrincipal)).div(eth);
			}
		);
		
		let sfiTotal;
		tasks.push(
		    async ()=>{
				//get SFI totals
			 	sfiTotal=await contractSFI.methods.totalSupply().call().catch((e)=>{
			 		console.log(`Error SFI totalSupply: ${e.message}`);
			 	});
			 	sfiTotal=(new BigNumber(sfiTotal)).div(eth);
			}
		);
		
		let sfiBalance;
		tasks.push(
		    async ()=>{
			 	//get SFI wallet balance
			 	sfiBalance=await contractSFI.methods.balanceOf(currentAccount).call().catch((e)=>{
			 		console.log(`Error SFI balanceOf: ${e.message}`);
			 	});
			 	sfiBalance=(new BigNumber(sfiBalance)).div(eth);
			}
		);
	 	
	 	//get portfolio principal token balance for this wallet
	 	let types=["S","AA","A"];
	 	let principal=new BigNumber(0);
	 	let dsec=new BigNumber(0);
	 	let dsecTotal=new BigNumber(0);
	 	let dsecPercentage;
	 	tasks.push(
		    async ()=>{
				for(let epoch=0;epoch<contractsSaffronV1PrincipalTokens.length;epoch++) {
					for(let i=0;i<types.length;i++) {
						let type=types[i];
						console.log("epoch:",epoch,"type:",type);

						let value=await contractsSaffronV1PrincipalTokens[epoch][type].methods.balanceOf(currentAccount).call().catch((e)=>{
					 		console.log(`Error contractsSaffronV1PrincipalTokens balanceOf: ${e.message}`);
					 	});
						principal=principal.plus(new BigNumber(value));

						value=await contractsSaffronV1DsecTokens[epoch][type].methods.balanceOf(currentAccount).call().catch((e)=>{
					 		console.log(`Error contractsSaffronV1DsecTokens balanceOf: ${e.message}`);
					 	});
						dsec=dsec.plus(new BigNumber(value));
						
						value=await contractsSaffronV1DsecTokens[epoch][type].methods.totalSupply().call().catch((e)=>{
					 		console.log(`Error contractsSaffronV1DsecTokens totalSupply: ${e.message}`);
					 	});
						dsecTotal=dsecTotal.plus(new BigNumber(value));
					}
				}
				console.log("principal:",principal,"dsec:",dsec,"dsecTotal:",dsecTotal);

				//calculate dsec %				
				if(dsecTotal.isEqualTo==(new BigNumber(0))) {
					dsecPercentage==new BigNumber(0);
				} else {
					dsecPercentage=dsec.div(dsecTotal);
				}
				console.log("dsecPercentage:",dsecPercentage);
			}
		);
	 	
	 	let trancheInterestEarned;
		tasks.push(
		    async ()=>{
			 	//TODO: update this because it is hardcoded for epoch 0, tranche 0 (S)
				trancheInterestEarned=await contractSaffronPool.methods.tranche_interest_earned(0,0).call().catch((e)=>{
			 		console.log(`Error tranche_interest_earned: ${e.message}`);
			 	});
				trancheInterestEarned=(new BigNumber(trancheInterestEarned)).div(eth);
				//check for no wind down yet
				if(isNaN(trancheInterestEarned)) trancheInterestEarned=new BigNumber(0);
				console.log("trancheInterestEarned:",trancheInterestEarned);
			}
		);
	 	
	 	let trancheSFIEarned;
		tasks.push(
		    async ()=>{
			 	//TODO: update this because it is hardcoded for epoch 0, tranche 0 (S)
				trancheSFIEarned=await contractSaffronPool.methods.tranche_SFI_earned(0,0).call().catch((e)=>{
			 		console.log(`Error tranche_SFI_earned: ${e.message}`);
			 	});
				trancheSFIEarned=(new BigNumber(trancheSFIEarned)).div(eth);
				//check for no wind down yet
				if(isNaN(trancheSFIEarned)) trancheSFIEarned=new BigNumber(0);		
			}
		);
	 	
		//calcluate Compound APY - https://compound.finance/docs
		let ethMantissa=1e18;
		let blocksPerDay=4*60*24;
		let daysPerYear=365;
		let supplyRatePerBlock,supplyApy;
		tasks.push(
		    async ()=>{
				supplyRatePerBlock=await contractCErc20DAI.methods.supplyRatePerBlock().call();
				supplyApy=(((Math.pow((supplyRatePerBlock/ethMantissa*blocksPerDay)+1,daysPerYear-1)))-1)*100;
				console.log(`Supply APY for ETH ${supplyApy} %`);
			}
		);
	 	
	 	let trancheAMultiplier;
		tasks.push(
		    async ()=>{
			    //get tranche A multiplier
				trancheAMultiplier=await contractSaffronPool.methods.tranche_A_multiplier().call().catch((e)=>{
					console.log(`Error getting tranche_A_multiplier: ${e.message}`);
				});	
				trancheAMultiplier=Number(trancheAMultiplier);	
			}
		);
	 	
	 	let trancheSFIMultipliers;
		tasks.push(
		    async ()=>{
				trancheSFIMultipliers=await contractSaffronPool.methods.TRANCHE_SFI_MULTIPLIER().call().catch((e)=>{
					console.log(`Error getting TRANCHE_SFI_MULTIPLIER: ${e.message}`);
				});			
			}
		);
	 	
	 	let response,prices;
		tasks.push(
		    async ()=>{
				//get prices
				response=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin%2Cethereum%2Csaffron-finance&vs_currencies=usd");
			    prices=await response.json(); // or text etc
			}
		);
	 	
	 	
	 	let currentEpoch;
	 	let epochEnd;
	 	let secsUntilRemoval;
	 	let timeUnits;
	 	let timeUntilRemoval="-NA-";
		tasks.push(
		    async ()=>{
				currentEpoch=await contractSaffronPool.methods.get_current_epoch().call().catch((e)=>{
					console.log(`Error getting current epoch: ${e.message}`);
				});
				currentEpoch=Number(currentEpoch);
			 	//get table expiration dates
			 	//TODO: future loop through all pools, get next expiration for each pool
			    epochEnd=await contractSaffronPool.methods.get_epoch_end(currentEpoch).call().catch((e)=>{
					console.log(`Error getting removal window start: ${e.message}`);
				});
			    epochEnd=Number(epochEnd);

				//get the seconds until removal window
				secsUntilRemoval=await contractSaffronPool.methods.get_seconds_until_epoch_end(currentEpoch).call().catch((e)=>{
					console.log(`Error get_seconds_until_epoch_end : ${e.message}`);
				});
				secsUntilRemoval=Number(secsUntilRemoval);
				//show biggest unit of time left
				timeUnits={day:86400,hour:3600,minute:60,second:1};
				timeUntilRemoval="-NA-";
				for(let timeUnit in timeUnits) {
					let value=Math.round(secsUntilRemoval/timeUnits[timeUnit]);
					if(value>0) {
						timeUntilRemoval=value+" "+timeUnit+(value>1?"s":"");
						break;
					}
				}
			    
			    console.log("epochEnd:",epochEnd,typeof epochEnd);
			}
		);
	 	
		//run all tasks and wait for them to finish
		await Promise.all(tasks.map(p => p()));	 

		/**** fill in html with data ****/
		
		hPortfolioPrincipalTokensDAI.textContent=hPortfolioPrincipalTokensAll.textContent=hPortfolioPrincipalTokens.textContent="$"+principal.div(eth).toFormat(2);
	 	//hHighestYieldAvailable.textContent=poolInterest;
	 	hTotalLiquidity.textContent="$"+poolPrincipal.toFormat(2);
// 	 	hTotalSupplySFI.textContent=sfiTotal.toFixed(2);
	 	hSfiTokensOwned.textContent=sfiBalance.toFixed(2)+" SFI";
// 		hPortfolioDsecTokensDAI.textContent=hPortfolioDsecTokens.textContent=(dsecPercentage.times(new BigNumber(100))).toFixed(2)+"%";
		hInterestEarned.textContent="$"+trancheInterestEarned.times(dsecPercentage).toFormat(2);
		//TODO: add SFI earnings to interest earnings
		hPortfolioEarnings.textContent=hInterestEarnedDAI.textContent=hInterestEarnedAll.textContent="$"+trancheInterestEarned.times(dsecPercentage).toFormat(2);
		topbarPortfolio.textContent=hPortfolioValue.textContent="$"+principal.div(eth).plus(trancheInterestEarned.times(dsecPercentage)).toFormat(2);	
		hSfiTokensEarnedDAI.textContent=hSfiTokensEarnedAll.textContent=hSfiTokensEarned.textContent=trancheSFIEarned.times(dsecPercentage).toFormat(2);

		tranchApyAA.textContent=hDaiAdapterAAHighestAPY.textContent=(parseInt(100*supplyApy/trancheAMultiplier)/100).toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:2})+"%";
		tranchApyS.textContent=hDaiAdapterAPY.textContent=hDaiAdapterSHighestAPY.textContent=(supplyApy).toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:2})+"%";
		tranchApyA.textContent=topbarHighestAPY.textContent=hDaiAdapterAHighestAPY.textContent=(supplyApy*trancheAMultiplier).toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:2})+"%";
		hDaiAdapterMultiplier.textContent=trancheAMultiplier+"X";
		
		trancheSFIMultiplierS.textContent=trancheSFIMultipliers["S"]+"%";
		trancheSFIMultiplierAA.textContent=trancheSFIMultipliers["AA"]+"%";
		trancheSFIMultiplierA.textContent=trancheSFIMultipliers["A"]+"%";
		
		console.log("poolPrincipal:",poolPrincipal,"dsecPercentage:",dsecPercentage,"supplyApy:",supplyApy);
		hInterestEstimated.textContent="$"+dsecPercentage.times(poolPrincipal).times(new BigNumber(supplyApy*14/36500)).toFormat(2);
		hSfiTokensEstimated.textContent=dsecPercentage.times(new BigNumber(30000/Math.pow(2,currentEpoch))).toFormat(2);

		//update top bar prices
		//TODO: get saffron-finance on coingecko
		topbarSFI.textContent="$"+("saffron-finance" in prices?prices["saffron-finance"].usd:0.00).toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:2});
		topbarETH.textContent="$"+(prices["ethereum"].usd).toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:2});
		topbarBTC.textContent="$"+(prices["bitcoin"].usd).toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:2});
		
		//clear existing table liquidity pool rows
		while(tblDashPoolExplorer.lastChild) tblDashPoolExplorer.removeChild(tblDashPoolExplorer.lastChild);
	    
    	//create new row from data
    	let tr,th,td,txt,button,b;
	    tr=document.createElement("tr");
	    tblDashPoolExplorer.appendChild(tr);
	    
	    //pool name
	    td=document.createElement("td");
	    b=document.createElement("b");
	    td.appendChild(b);
	    txt=document.createTextNode("DAI POOL");
	    b.appendChild(txt);
	    tr.appendChild(td);

	    //estimated weekly
	    td=document.createElement("td");
	    txt=document.createTextNode("-NA-");
	    td.appendChild(txt);
	    tr.appendChild(td);
	    
	    //poolInterest
	    td=document.createElement("td");
	    txt=document.createTextNode(poolInterest.toFixed(2)+"%");
	    td.appendChild(txt);
	    tr.appendChild(td);
	    
	    //SFI Earnings
	    td=document.createElement("td");
	    txt=document.createTextNode(sfiTotal.toFormat(2));
	    td.appendChild(txt);
	    tr.appendChild(td);
	    
	    //poolPrincipal
	    td=document.createElement("td");
	    txt=document.createTextNode("$"+poolPrincipal.toFormat(2));
	    td.appendChild(txt);
	    tr.appendChild(td);
	    
    	//clear existing table expiration date rows
		while(tblDashExpirationDates.lastChild) tblDashExpirationDates.removeChild(tblDashExpirationDates.lastChild);
	    
    	//create new row from data
	    tr=document.createElement("tr");
	    tblDashExpirationDates.appendChild(tr);
	    
	    //currency
	    td=document.createElement("td");
	    b=document.createElement("b");
	    td.appendChild(b);
	    txt=document.createTextNode("DAI POOL");
	    b.appendChild(txt);
	    tr.appendChild(td);

	    //current epoch
	    td=document.createElement("td");
	    txt=document.createTextNode(currentEpoch);
	    td.appendChild(txt);
	    tr.appendChild(td);
	    
	    //pool balance
	    td=document.createElement("td");
	    txt=document.createTextNode("$"+poolPrincipal.toFormat(2));
	    td.appendChild(txt);
	    tr.appendChild(td);
	    
	    //removal start date column
	    td=document.createElement("td");
	    txt=document.createTextNode(new Date(epochEnd*1000).toLocaleString("en-US"));
	    td.appendChild(txt);
	    tr.appendChild(td);
	    
	    //removal end date column
	    td=document.createElement("td");
	    txt=document.createTextNode(timeUntilRemoval);
	    td.appendChild(txt);
	    tr.appendChild(td);
	    
	    //update dashboardChart
	    updateDashboardChart();
	    
		//update redeem removal times and progress bar
		await updateRedeemRemovalTimes();
	    
		//stop spinner, enable refresh buttons
		for(let i=0;i<btnsRefresh.length;i++) {
			btnsRefresh[i].firstElementChild.classList.remove("fa-spin");
			btnsRefresh[i].disabled=false;
		}
	    
	}
	
	async function updateRedeemRemovalTimes() {
	 	//get table expiration dates
	 	//TODO: future loop through all pools, get next expiration for each pool
		let currentEpoch=await contractSaffronPool.methods.get_current_epoch().call().catch((e)=>{
			console.log(`Error getting current epoch: ${e.message}`);
		});
		currentEpoch=Number(currentEpoch);
	    let epochEnd=await contractSaffronPool.methods.get_epoch_end(currentEpoch).call().catch((e)=>{
			console.log(`Error getting removal window start: ${e.message}`);
		});
	    epochEnd=Number(epochEnd);
	    
	    //update redeem pool end date
	    redeemTabNextRemovalWindow.textContent=new Date(epochEnd*1000).toLocaleString("en-US");
		//get the seconds until removal window
		let secsUntilRemoval=await contractSaffronPool.methods.get_seconds_until_epoch_end (currentEpoch).call().catch((e)=>{
			console.log(`Error get_seconds_until_epoch_end : ${e.message}`);
		});
		secsUntilRemoval=Number(secsUntilRemoval);
		let cycleParams=await contractSaffronPool.methods.get_epoch_cycle_params().call().catch((e)=>{
			console.log(`Error get_epoch_cycle_params: ${e.message}`);
		});
		console.log("cycleParams:",JSON.stringify(cycleParams));
		let epochDurationSecs=parseInt(cycleParams["1"]);
		let epochRemovalDurationSecs=parseInt(cycleParams["2"]);
		
		//check for last removal window end to see if we are in that still
		let secsUntilRemovalWindowEnd=0;
// 		if(currentEpoch>0) {
// 		    let lastRemovalWindowEnd=await contractSaffronPool.methods.get_removal_window_end(currentEpoch-1).call().catch((e)=>{
// 				console.log(`Error getting removal window end: ${e.message}`);
// 			});
// 		    console.log("currentEpoch-1:",currentEpoch-1);
// 		    lastRemovalWindowEnd=Number(lastRemovalWindowEnd);
// 		    lastRemovalWindowEndTime=new Date(lastRemovalWindowEnd*1000);
// 		    console.log("lastRemovalWindowEndTime:",lastRemovalWindowEndTime,lastRemovalWindowEndTime.toLocaleString("en-US"));
// 		    secsUntilRemovalWindowEnd=(lastRemovalWindowEndTime-new Date())/1000;
// 		    console.log("secsUntilRemovalWindowEnd:",secsUntilRemovalWindowEnd);
// 		}
		
		if(false) {//secsUntilRemovalWindowEnd>0) {
			//show this until removal window end
			secsUntilRemoval=secsUntilRemovalWindowEnd;
			redeemTabNextRemovalText.textContent="This Window Ending In:";
			btnPoolRedeemDai.disabled=false;
			redeemTabProgressBar.classList.remove("bg-primary");
			redeemTabProgressBar.classList.add("bg-success");
			epochDurationSecs=epochRemovalDurationSecs;
		} else {
			redeemTabNextRemovalText.textContent="Epoch Ending In:";
			btnPoolRedeemDai.disabled=false; //true;
			redeemTabProgressBar.classList.add("bg-primary");
			redeemTabProgressBar.classList.remove("bg-success");
		}
		
		//show biggest unit of time left
		let timeUnits={day:86400,hour:3600,minute:60,second:1};
		let timeDelays={day:3600,hour:300,minute:30,second:15};
		let timeDelay;
		for(let timeUnit in timeUnits) {
			let value=Math.round(secsUntilRemoval/timeUnits[timeUnit]);
			if(value>0) {
				redeemTabNextRemovalTime.textContent=value+" "+timeUnit+(value>1?"s":"");
				//set time delay for next call to refresh progress bar
				timeDelay=timeDelays[timeUnit]*1000;
				break;
			}
		}
		console.log("secsUntilRemoval:",secsUntilRemoval,typeof secsUntilRemoval);
		console.log("epochDurationSecs:",epochDurationSecs,typeof epochDurationSecs);
		
		//update redeem pool progress bar
		let epochCompletedPercentage=100-Math.floor(100*secsUntilRemoval/epochDurationSecs);
		redeemTabProgressBar.style.width=epochCompletedPercentage+"%";
		redeemTabProgressBar.setAttribute("aria-valuenow",epochCompletedPercentage);
		redeemTabProgressBar.textContent=epochCompletedPercentage+"%";
		
		setTimeout(updateRedeemRemovalTimes,timeDelay);
	}

	async function updateDashboardChart() {		
		historyLoading.classList.remove("hide");
		
	    let currentBlockNumber=await web3.eth.getBlockNumber();
	    console.log("currentBlockNumber:",currentBlockNumber,typeof currentBlockNumber);
	    let days=parseInt(dashboardGraphDays.value);
	    let fromBlock=currentBlockNumber-(days*5760); //28 days times 5760 blocks per day average (15 sec blocks)
	    
// 	    localStorage.setItem(dataStorageKey,JSON.stringify(abiData));
// 	    let eventHistoryKey="eventHistory";
// 		let eventHistory=localStorage.getItem(eventHistoryKey);
// 		//console.log("loadABIData() abiData: ",abiData);
		
// 		//if abi data exists
// 		if(!eventHistory) {
// 			eventHistory=[];
// 		} else {
// 			//parse JSON into object
// 			eventHistory=JSON.parse(eventHistory);
// 		}
				
	 	let eventsAddLiquidity=await contractSaffronPool.getPastEvents("AddLiquidity",{fromBlock:fromBlock,toBlock:"latest"}).catch((e)=>{
	 		console.log(`Error getPastEvents AddLiquidity: ${e.message}`);
	 	});
	    console.log("eventsAddLiquidity:",JSON.stringify(eventsAddLiquidity));

	    //loop through event data, build event history
	    let history=[];
	    let eth=new BigNumber("1e18");
	    for(let i=0;i<eventsAddLiquidity.length;i++) {
	    	let eventAddLiquidity=eventsAddLiquidity[i];
	    	history.push({
	    		"blockNumber":eventAddLiquidity.blockNumber,
	    		"principal":(new BigNumber(eventAddLiquidity.returnValues.new_pool_principal)).div(eth).toFixed(2)
	    	});
	    }

	    //get all blocks timestamps
	    console.log("get all blocks timestamps");
		let tasks=[];
		for(let h of history) {
			tasks.push(
			    async ()=>{
			    	let block=await web3.eth.getBlock(h.blockNumber);
		 			let dt=new Date(block.timestamp*1000);
		 			h.isoTime=dt.toISOString().split(".")[0];
			    }
			);
		}
		await Promise.all(tasks.map(p => p()));	 
		console.log("got all blocks timestamps");
	    
	    //clear graph data options
	    let series=[{
            name: 'Pool Principal',
            data: []
        }];
	    
	  	//now update graph data
	    let categories=[];		
	    for(let h of history) {
	    	series[0].data.push(h.principal);
	    	categories.push(h.isoTime);
	    }

	    console.log("series:",JSON.stringify(series));
	    console.log("categories:",JSON.stringify(categories));
	    
	    historyLoading.classList.add("hide");

	    dashboardChart.updateOptions({
	    	series:series,
	    	xaxis: {
	    		categories: categories
	    	}
	    });
	}
	
	//saffron alert box
	function saffronAlert(message,header,hide=false) {
		if(hide) {
			$("#modalAlertSaffron").modal("hide");
			document.getElementById("modalAlertMessage").innerHTML="";
		} else {
			//set header for alert box
			if(!header) {
				document.getElementById("modalAlertHeader").textContent="Saffron Alert!";
			} else {
				document.getElementById("modalAlertHeader").textContent=header;
			}
			//set message for alert box
			document.getElementById("modalAlertMessage").innerHTML=message;
			
			$("#modalAlertSaffron")
					.modal({
						keyboard: false
					})
					.modal("show");
		}
	}
	function setCountDown() {
		let counter=document.getElementById("counter");
		if(counter) {
			 $("#counter").countdown( new Date(1604239200000), function(event) {
			        $(this).html(
			            event.strftime('<div><div class="countdown-block"><span class="text-primary font-40">%D</span><br><span class="text-muted font-16">Days</span></div><div class="countdown-block"><span class="text-primary font-40">%H</span><br><span class="text-muted font-16">Hours</span></div><div class="countdown-block"><span class="text-primary font-40">%M</span><br><span class="text-muted font-16">Minutes</span></div><div class="countdown-block"><span class="text-primary font-40">%S</span><br><span class="text-muted font-16">Seconds</span></div></div>')
			        );
			 });
		} else {
			setTimeout(setCountDown,1000);
	}	
	}
	//connect wallet modal
	function connectWallet() {
/*        swal({
            title: 'Coming soon *',
            html: "<h5>DAI liquidity mining starts in:</h5><div class='coming-soon'><div id='counter'></div></div><br><h6 class='text-primary'>* Amounts and balances are for demo purposes only</h6>",
            showConfirmButton: true,
            imageUrl: "assets/images/saffron.png",
            imageWidth: "48px"
        }).then(
        	function () {
            },
            function(dismiss) {
//              	clearInterval(timerInterval);
            }
        );
        setCountDown()*/

		$("#modalConnectWallet").off("hide.bs.modal").on("hide.bs.modal", function (e) { 
			var tmpid = $(document.activeElement).data("wallet-name");
			switch(tmpid) {
				case "metamask":
					connectWeb3();
					break;
				case "fortmatic":
					break;
				case "authereum":
					break;
				case "coinbase":
					break;
				case "ledger":
					break;
				case "portis":
					break;
				case "squarelink":
					break;
				case "torus":
					break;
				case "trezor":
					break;
				case "trustwallet":
					break;
				case "walletconnect":
					break;

			}			
		}); 
		
		$("#modalConnectWallet").modal("show");
	}
	
	async function updateDepositDAIModal(initialize=false) {
		//reset range slider if needed
		if(timerModalPoolSlider) {
			clearTimeout(timerModalPoolSlider);
			timerModalPoolSlider=null;
		}
		
		//get the current epoch number
		currentEpoch=await contractSaffronPool.methods.get_current_epoch().call().catch((e)=>{
			console.log(`Error getting current epoch: ${e.message}`);
		});	
		currentEpoch=Number(currentEpoch);
		//get the seconds until removal window
		secsUntilRemoval=await contractSaffronPool.methods.get_seconds_until_epoch_end (currentEpoch).call().catch((e)=>{
			console.log(`Error get_seconds_until_epoch_end : ${e.message}`);
		});
		secsUntilRemoval=Number(secsUntilRemoval);
		
	    epochEnd=await contractSaffronPool.methods.get_epoch_end(currentEpoch).call().catch((e)=>{
			console.log(`Error getting removal window start: ${e.message}`);
		});
	    epochEnd=Number(epochEnd);
		
		cycleParams=await contractSaffronPool.methods.get_epoch_cycle_params().call().catch((e)=>{
			console.log(`Error get_epoch_cycle_params: ${e.message}`);
		});
		console.log("cycleParams:",JSON.stringify(cycleParams));
		let epochDurationSecs=parseInt(cycleParams["1"]);
		let timeUnit,timeDivisor;
		if(epochDurationSecs<3600) {
			timeUnit="minutes";
			timeDivisor=60;
		} else if(epochDurationSecs<86400) {
			timeUnit="hours";
			timeDivisor=3600;
		} else {
			timeUnit="days";
			timeDivisor=86400;
		}
		
		console.log("secsUntilRemoval:",secsUntilRemoval);
		//calculate minimum time to start (current epoch time remaining)
		let timeMin=Math.floor(secsUntilRemoval/timeDivisor);
		let timeStep=Math.floor(epochDurationSecs/timeDivisor);
		
	    /* -- Range Slider - Value Seperator to -- */
	    // http://ionden.com/a/plugins/ion.rangeSlider/api.html
	    let futureEpochs=10;
	    modalPoolSliderOptions={
	    	grid: true,
	    	grid_num: futureEpochs,
	        min: timeMin,  		//TODO: get days out   get_seconds_until_epoch_end (epoch)
	        max: timeMin+timeStep*futureEpochs,	//TODO: get durations  get_epoch_cycle_params ( ) .call()
	        step: timeStep,		//TODO: get durations  get_epoch_cycle_params ( ) .call()
	        prefix: "Duration: ",
	        postfix: " "+timeUnit
	    };
	    if(!modalPoolSliderRange) {
	    	//add events to slider
	    	modalPoolSliderOptions.from=timeMin;
	    	modalPoolSliderOptions.onUpdate=function(data) {
	    		console.log("slider onUpdate:",data.from);
	    		modalPoolSliderValue=data.from;
				console.log("data.from:",data.from);
	    		let epoch=Math.floor((modalPoolSliderValue-modalPoolSliderOptions.min)/modalPoolSliderOptions.step);
	    		console.log("deposit epoch:",epoch,typeof epoch);
	    		updateRedemptionDate(epoch);
	    	}
	    	modalPoolSliderOptions.onChange=function(data) {
	    		console.log("slider onChange:",data.from);
	    		modalPoolSliderValue=data.from;
				console.log("data.from:",data.from);
	    		let epoch=Math.floor((modalPoolSliderValue-modalPoolSliderOptions.min)/modalPoolSliderOptions.step);
	    		console.log("deposit epoch:",epoch,typeof epoch);
	    		updateRedemptionDate(epoch);
	    	}
		    $("#modal-pool-duration-slider").ionRangeSlider(modalPoolSliderOptions);
    		//update redemption date
    		updateRedemptionDate(0);
		    
		    modalPoolSliderRange=$("#modal-pool-duration-slider").data("ionRangeSlider");
	    } else {
	    	//if not called from timer, but by user opening modal, then reset "from" position
	    	if(initialize) {
	    		//set default from position
	    		modalPoolSliderOptions.from=timeMin;
	    		//update redemption date
	    		updateRedemptionDate(0);
	    	}
	    	modalPoolSliderRange.update(modalPoolSliderOptions);
	    }
	    
	    //get balance of users DAI
	 	let available=await contractDAI.methods.balanceOf(currentAccount).call().catch((e)=>{
	 		console.log(`Error SFI balanceOf: ${e.message}`);
	 	});
	    depositDaiBalance=new BigNumber(available);
	    console.log("depositDaiBalance:",depositDaiBalance.toString());
	    modalDepositDaiBalance.textContent=depositDaiBalance.div(new BigNumber(1e18)).toFormat(2)+" DAI";
	    
	    //set tranche A multiplier in text description
		let trancheAMultiplier=await contractSaffronPool.methods.tranche_A_multiplier().call().catch((e)=>{
			console.log(`Error getting tranche_A_multiplier: ${e.message}`);
		});
		spanATrancheMultiplier.textContent=trancheAMultiplier;

	    timerModalPoolSlider=setTimeout(updateDepositDAIModal,60000);
	}
	
	async function updateRedemptionDate(additionalEpochs) {
		additionalEpochs=Number(additionalEpochs);
		let epochDurationSecs=parseInt(cycleParams["1"]);
		console.log("additionalEpochs:",additionalEpochs,"epochDurationSecs:",epochDurationSecs);
	    let futureTime=epochEnd+additionalEpochs*epochDurationSecs
	    modalDepositDaiRedeemDate.textContent=new Date(futureTime*1000).toLocaleString("en-US");
	}

	//deposit dai modal
	async function showDepositDaiModal() {
		//clear deposit amount
		modalDepositDaiAmount.value="0.00";
		//set S tranche
		modalDepositS.checked=true;
		await updateDepositDAIModal(true);
	    
		$("#modalDepositDai").off("hide.bs.modal").on("hide.bs.modal",async function (e) {
			//reset range slider
			if(timerModalPoolSlider) {
				clearTimeout(timerModalPoolSlider);
				timerModalPoolSlider=null;
			}
			//clear invalid if there was one
			modalDepositDaiAmount.classList.remove("is-invalid");
			
//  			var button=$(document.activeElement).data("deposit-dai-button");
//  			console.log("button:",button);
		}); 
		
		$("#modalDepositDai").modal("show");
	}	
	
	async function updateRedeemDAIModal() {
		//get int value of tranche
		let type,index,types=["S","AA","A"];
        let tranches=document.getElementsByName("modalRedeemDaiTranches"); 
        for(let tranche of tranches) {
        	if(tranche.checked) {
        		index=parseInt(tranche.value);
        		type=types[index];
        		break;
        	}
        }
 		
        //clear deposit amounts
		modalRedeemPrincipalAmount.textContent="0.00 DAI";
		modalRedeemInterestAmount.textContent="0.00 DAI";
		modalRedeemSFIAmount.textContent="0.00 SFI";

		//get current epoch
		let currentEpoch=await contractSaffronPool.methods.get_current_epoch().call().catch((e)=>{
			console.log(`Error getting current epoch: ${e.message}`);
		});
		currentEpoch=Number(currentEpoch);
		let epoch=currentEpoch-1;
		console.log("redeem epoch:",epoch,"type:",type);
		//TODO: allow for more epochs
		if(epoch>-1 && epoch<2) {
		
			//get this wallets balance token totals
			//get principal
			redeemPrincipalBalance=await contractsSaffronV1PrincipalTokens[epoch][type].methods.balanceOf(currentAccount).call().catch((e)=>{
		 		console.log(`Error contractsSaffronV1PrincipalTokens balanceOf: ${e.message}`);
		 	});
			redeemPrincipalBalance=BigNumber(redeemPrincipalBalance);
	
			//get dsec
			redeemDsecBalance=await contractsSaffronV1DsecTokens[epoch][type].methods.balanceOf(currentAccount).call().catch((e)=>{
		 		console.log(`Error contractsSaffronV1DsecTokens balanceOf: ${e.message}`);
		 	});
			redeemDsecBalance=BigNumber(redeemDsecBalance);
			
			//get total supply of dsec to calculate percentage
			redeemDsecTotal=await contractsSaffronV1DsecTokens[epoch][type].methods.totalSupply().call().catch((e)=>{
		 		console.log(`Error contractsSaffronV1DsecTokens totalSupply: ${e.message}`);
		 	});
			redeemDsecTotal=BigNumber(redeemDsecTotal);
			
		 	//get tranche interest
			redeemInterest=await contractSaffronPool.methods.tranche_interest_earned(epoch,index).call().catch((e)=>{
		 		console.log(`Error tranche_interest_earned: ${e.message}`);
		 	});
			redeemInterest=BigNumber(redeemInterest);
			//check for no wind down yet
			if(isNaN(redeemInterest)) redeemInterest=new BigNumber(0);
			
			//get tranche SFI
			redeemSFI=await contractSaffronPool.methods.tranche_SFI_earned(epoch,index).call().catch((e)=>{
		 		console.log(`Error tranche_SFI_earned: ${e.message}`);
		 	});
			redeemSFI=BigNumber(redeemSFI);
			//check for no wind down yet
			if(isNaN(redeemSFI)) redeemSFI=new BigNumber(0);				
			
			//calculate dsec percentage
			let dsecPercentage=redeemDsecBalance.div(redeemDsecTotal);
			if(isNaN(dsecPercentage)) dsecPercentage=new BigNumber(0);	
			
			//set amounts on redeem modal
			redeemInterestBalance=dsecPercentage.times(redeemInterest);
			redeemSFIBalance=dsecPercentage.times(redeemSFI);
			
		} else {
			redeemPrincipalBalance=new BigNumber(0);	
			redeemInterestBalance=new BigNumber(0);	
			redeemSFIBalance=new BigNumber(0);	

// 	 		//TESTING
// 	 		redeemPrincipalBalance=BigNumber(63000033852344615881);
// 	 		redeemDsecBalance=BigNumber(50000000000000000000000);
// 	 		redeemDsecTotal=  BigNumber(100000000000000000000000);
// 	 		redeemInterest=   BigNumber(5000000000000000000);
// 	 		redeemSFI=        BigNumber(30000000000000000000000);
// 			//calculate dsec percentage
// 			let dsecPercentage=redeemDsecBalance.div(redeemDsecTotal);
// 			if(isNaN(dsecPercentage)) dsecPercentage=new BigNumber(0);	
			
// 			//set amounts on redeem modal
// 			redeemInterestBalance=dsecPercentage.times(redeemInterest);
// 			redeemSFIBalance=dsecPercentage.times(redeemSFI);

		}

		modalRedeemPrincipalBalance.textContent=redeemPrincipalBalance.div(new BigNumber(1e18)).toFormat(2)+" DAI";
		modalRedeemInterestBalance.textContent=redeemInterestBalance.div(new BigNumber(1e18)).toFormat(2)+" DAI";
		modalRedeemSFIBalance.textContent=redeemSFIBalance.div(new BigNumber(1e18)).toFormat(2)+" SFI";
// 		inputAvailSV1.value=available/1e18;
// 		console.log(portfolio+" available:",available);	
	}

	//redeem dai modal
	async function showRedeemDaiModal() {
		//set S tranche
		modalRedeemS.checked=true;
	
		//set to Redeem Principal
		modalRedeemPrincipal.checked=true;
		
		//update visible boxes
        $("#rowRedeemPrincipal").addClass("show");
        $("#rowRedeemInterestSFI").removeClass("show");
        
        //update current values
        updateRedeemDAIModal();
		//await updateRedeemDAIModal(true);
	    
		$("#modalRedeemDai").off("hide.bs.modal").on("hide.bs.modal",async function (e) {
// 			//reset range slider
// 			if(timerModalPoolSlider) {
// 				clearTimeout(timerModalPoolSlider);
// 				timerModalPoolSlider=null;
// 			}
			//clear invalid if there was one
			modalRedeemPrincipalAmount.classList.remove("is-invalid");
			modalRedeemInterestAmount.classList.remove("is-invalid");
			modalRedeemSFIAmount.classList.remove("is-invalid");
//  			var button=$(document.activeElement).data("deposit-dai-button");
//  			console.log("button:",button);
		}); 
		
		$("#modalRedeemDai").modal("show");
	}	
	
	
	function disableModalDepositButtons(disable) {
		//tranche radio choices
		modalDepositAA.disabled=disable;
		modalDepositA.disabled=disable;
		modalDepositS.disabled=disable;
		
		//amount percentage buttons
		document.querySelectorAll(".amountPercent").forEach(button=>{
			button.disabled=disable;
		});	
		
		//confirm loading circle
		if(disable) {
			btnAddLiquidity.firstElementChild.classList.remove("hide");
		} else {
			btnAddLiquidity.firstElementChild.classList.add("hide");
		}
		
		//confirm/cancel buttons
		btnAddLiquidity.disabled=disable;
		btnCancelAddLiquidity.disabled=disable;
		btnCancelAddLiquidity2.disabled=disable;
		
		//duration slider
		modalPoolSliderRange.update({block:disable});
	}
	
	async function addLiquidity() {
		// VALIDATE AMOUNT
		let addAmount=new BigNumber(modalDepositDaiAmount.value);
		//check that is a number, if not set to 0
		if(isNaN(addAmount)) addAmount=new BigNumber(0);
		//truncate to max of 8 decimals for COMPOUND not returning more than 8 digits precision on deposits
		addAmount=new BigNumber(addAmount.toFixed(8));
		//multiply by 1e18
		addAmount=addAmount.times(new BigNumber("1e18"));
		//check that is greater than 0 and less than or equal to deposit balance
		if(addAmount.isLessThanOrEqualTo(new BigNumber(0)) || addAmount.isGreaterThan(depositDaiBalance)) {
			modalDepositDaiAmount.classList.add("is-invalid");
			saffronAlert("Please enter a valid amount!","Invalid Entry");
			return;
		}
		modalDepositDaiAmount.classList.remove("is-invalid");
		disableModalDepositButtons(true);
		
		// disable slider refresh timer
		if(timerModalPoolSlider) {
			clearTimeout(timerModalPoolSlider);
			timerModalPoolSlider=null;
		}
		
		// GET REQUESTED EPOCH (FUTURE)
		//get the current epoch number in case it changed
		let currentEpoch=await contractSaffronPool.methods.get_current_epoch().call().catch((e)=>{
			console.log(`Error getting current epoch: ${e.message}`);
		});
		currentEpoch=Number(currentEpoch);
		console.log("currentEpoch:",currentEpoch,typeof currentEpoch);	
		
		//get duration slider value
		let from=$("#modal-pool-duration-slider").data("from");
		
		//get the epoch to add to the current epoch
		let epoch=Math.floor((from-modalPoolSliderOptions.min)/modalPoolSliderOptions.step);
		console.log("deposit epoch:",epoch,typeof epoch);	
		epoch+=currentEpoch;
		console.log("deposit epoch:",epoch);	
		
		//get the allowance, if any, from previous add_liquidity
		let allowance=await contractDAI.methods.allowance(currentAccount,addressSaffronPool[chainInfo.shortName]).call().catch((e)=>{
			console.log(`Error getting allowance: ${e.message}`);
		});
		console.log("allowance:",allowance,typeof allowance);
 		allowance=new BigNumber(allowance);

 		//check if any needs to be approved (may not have to due to failed previous transaction)
 		let approvalAmount=addAmount.minus(allowance);
 		console.log("addAmount:",addAmount.toString());
 		console.log("allowance:",allowance.toString());
 		console.log("approvalAmount:",approvalAmount.toString());
		let tokensDAI=web3.utils.toBN("0x"+addAmount.toString(16));
		
 		//if approvalAmount is more than 0 then need to approve that much
		if(approvalAmount.isGreaterThan(new BigNumber(0))) {
			// https://sweetalert2.github.io/#usage
            swal({
                title: 'Approving DAI',
                html: "<h5><i class='fa fa-spin fa-refresh'></i> Please approve pool to spend DAI</h5><br>",
                showConfirmButton: false,
                imageUrl: "assets/images/saffron.png",
                imageWidth: "48px"
            });

			//call base DAI to approve use of DAI for pool
			let failure=false;
			await contractDAI.methods.approve(addressSaffronPool[chainInfo.shortName],tokensDAI).send({
				from:currentAccount
// 				from:currentAccount,
//  			    gasLimit:web3.utils.toHex(300000),     // posted at compound.finance/developers#gas-costs
//  			    gasPrice:web3.utils.toHex(20000000000) // use ethgasstation.info (mainnet only)
			}).catch((e)=>{
				swal.close();
				console.log(`Error contact DAI approve: ${e.message}`);
				saffronAlert(e.message.split(":")[0],"Approve Error");
				failure=true;
			});
			if(failure) {
				disableModalDepositButtons(false);
				//restart slider update timer and exit
				timerModalPoolSlider=setTimeout(updateDepositDAIModal,60000);
				return;
			}
			swal.close();
			console.log("contractDAI.methods.approve addressSaffronPool:",tokensDAI);
		}
		
		//get int value of tranche
		let portfolio;
        let tranches=document.getElementsByName("modalDepositDaiTranches"); 
        for(let tranche of tranches) {
        	if(tranche.checked) {
        		portfolio=parseInt(tranche.value);
        		break;
        	}
        }
		
		//add DAI to SaffronPool
        swal({
            title: 'Depositing DAI',
            html: "<h5><i class='fa fa-spin fa-refresh'></i> Deposit DAI into the pool</h5><br>",
            showConfirmButton: false,
            imageUrl: "assets/images/saffron.png",
            imageWidth: "48px"
        });

		console.log("calling add_liquidity with portfolio:"+portfolio+"\ttokensDAI:"+tokensDAI);
		failure=false;
		await contractSaffronPool.methods.add_liquidity(tokensDAI,portfolio).send({
			from:currentAccount
// 			from:currentAccount,
//  		    gasLimit:web3.utils.toHex(300000),     // posted at compound.finance/developers#gas-costs
//  		    gasPrice:web3.utils.toHex(20000000000) // use ethgasstation.info (mainnet only)
		}).catch((e)=>{
			swal.close();
			console.log(`Error contractSaffronPool add_liquidity: ${e.message}`);
			saffronAlert(e.message.split(":")[0],"Add Liquidity Error");
			failure=true;
		});
		if(failure) {
			disableModalDepositButtons(false);
			//restart slider update timer and exit
			timerModalPoolSlider=setTimeout(updateDepositDAIModal,60000);
			return;
		}
		swal.close();
		console.log("contractSaffronPool.methods.add_liquidity "+(portfolio==0?"AA":portfolio==1?"A":"S")+":",tokensDAI);
		
		//get new balances
		await updateBalances();
		disableModalDepositButtons(false);

		console.log("Approved "+tokensDAI+" for SaffronPool at "+addressSaffronPool);
        swal({
            title: 'Successful Deposit',
            html: "<h5><i class='fa fa-spin fa-refresh'></i> Your DAI was deposited into the pool</h5><br>",
            imageUrl: "assets/images/saffron.png",
            timer: 3000,
            imageWidth: "48px"
        });
		
		//hide modal
		$("#modalDepositDai").modal("hide");
	}
	
	function disableModalRedeemButtons(disable) {
		//tranche radio choices
		modalRedeemAA.disabled=disable;
		modalRedeemA.disabled=disable;
		modalRedeemS.disabled=disable;
		
		//amount percentage buttons
		document.querySelectorAll(".amountPercent").forEach(button=>{
			button.disabled=disable;
		});	
		
		document.getElementsByName("modalRedeemWhat").forEach(button=>{
			button.disabled=disable;
		});	
		
		//confirm loading circle
		if(disable) {
			btnRemoveLiquidity.firstElementChild.classList.remove("hide");
		} else {
			btnRemoveLiquidity.firstElementChild.classList.add("hide");
		}
		
		//confirm/cancel buttons
		btnRemoveLiquidity.disabled=disable;
		btnCancelRemoveLiquidity.disabled=disable;
		btnCancelRemoveLiquidity2.disabled=disable;
	}


	async function removeLiquidity() {
		//get amounts typed in
		let principalAmount=new BigNumber(modalRedeemPrincipalAmount.value);
 		if(isNaN(principalAmount)) principalAmount=new BigNumber(0);
		//truncate to max of 8 decimals for COMPOUND not returning more than 8 digits precision on deposits
// 		principalAmount=new BigNumber(principalAmount.toFixed(8));
		//multiply by 1e18
		principalAmount=principalAmount.times(new BigNumber("1e18"));
 		
		let interestAmount=new BigNumber(modalRedeemInterestAmount.value);
 		if(isNaN(interestAmount)) interestAmount=new BigNumber(0);
		//truncate to max of 8 decimals for COMPOUND not returning more than 8 digits precision on deposits
// 		interestAmount=new BigNumber(interestAmount.toFixed(8));
		//multiply by 1e18
		interestAmount=interestAmount.times(new BigNumber("1e18"));
		
 		let sfiAmount=new BigNumber(modalRedeemSFIAmount.value);
 		if(isNaN(sfiAmount)) sfiAmount=new BigNumber(0);
		//truncate to max of 8 decimals for COMPOUND not returning more than 8 digits precision on deposits
// 		sfiAmount=new BigNumber(sfiAmount.toFixed(8));
		//multiply by 1e18
		sfiAmount=sfiAmount.times(new BigNumber("1e18"));
 		
 		console.log("principalAmount:",principalAmount.toString());
 		console.log("interestAmount:",interestAmount.toString());
 		console.log("sfiAmount:",sfiAmount.toString());
 		
 		//set default amounts to 0
 		let amountPrincipal="0x0";
 		let amountDsec="0x0";
 		let title="";
 		
 		//see what they want to redeem
 		if(modalRedeemPrincipal.checked || modalRedeemBoth.checked) {
 			//redeem principal
			if(principalAmount.isLessThanOrEqualTo(new BigNumber(0)) || principalAmount.isGreaterThan(redeemPrincipalBalance)) {
				modalRedeemPrincipalAmount.classList.add("is-invalid");
				saffronAlert("Please enter a valid amount!","Invalid Entry");
				return;
			}
 			//update amount of principal to remove
			amountPrincipal=web3.utils.toBN("0x"+(principalAmount).toString(16));
			console.log("amountPrincipal:",amountPrincipal);
 			//update title for swal box
 			title="Principal";
 			
 			
 		} 
 		if(modalRedeemInterestSFI.checked || modalRedeemBoth.checked) {
 			//redeem interest and sfi
			if(interestAmount.isLessThanOrEqualTo(new BigNumber(0)) || interestAmount.isGreaterThan(redeemInterestBalance)) {
				modalRedeemInterestAmount.classList.add("is-invalid");
				saffronAlert("Please enter a valid amount!","Invalid Entry");
				return;
			} 
			if(sfiAmount.isLessThanOrEqualTo(new BigNumber(0)) || sfiAmount.isGreaterThan(redeemSFIBalance)) {
				console.log("sfiAmount:",sfiAmount.toString(),"redeemSFIBalance",redeemSFIBalance.toString());
				modalRedeemSFIAmount.classList.add("is-invalid");
				saffronAlert("Please enter a valid amount!","Invalid Entry");
				return;
			}
			//update amount of dsec to remove
			//calculate dsec percentage
			let dsecPercentage=interestAmount.div(redeemInterestBalance);
			//TODO: maybe calculate sfiAmount/redeemSfiBalance and make sure ratios are the same
			//TODO: maybe verify dsecAmount .. dsecPercentage should never exceed 1.0 so amount should be available
			let dsecAmount=(dsecPercentage.isEqualTo(new BigNumber(1.0))?redeemDsecBalance:dsecPercentage.times(redeemDsecBalance));
			console.log("dsecAmount:",dsecAmount.toString());
			//calculate amount of dsec
			amountDsec=web3.utils.toBN("0x"+(dsecAmount).toString(16));

			//update title for swal box
 			title+=(title==""?"":" And ")+"Interest/SFI";
 		}
  		console.log("amountPrincipal:",amountPrincipal);
 		console.log("amountDsec:",amountDsec);
 		
		//clear invalid if there was one
		modalRedeemPrincipalAmount.classList.remove("is-invalid");
		modalRedeemInterestAmount.classList.remove("is-invalid");
		modalRedeemSFIAmount.classList.remove("is-invalid");
		disableModalRedeemButtons(true);

		//get current epoch
		let currentEpoch=await contractSaffronPool.methods.get_current_epoch().call().catch((e)=>{
			console.log(`Error getting current epoch: ${e.message}`);
		});
		currentEpoch=Number(currentEpoch);
		let epoch=currentEpoch-1;

		//redeem from previous epoch
		//TODO: allow for more epochs
		if(epoch>-1 && epoch<1) {

			//get int value of tranche
			let type,index,types=["S","AA","A"];
	        let tranches=document.getElementsByName("modalRedeemDaiTranches"); 
	        for(let tranche of tranches) {
	        	if(tranche.checked) {
	        		index=parseInt(tranche.value);
	        		type=types[index];
	        		break;
	        	}
	        }
			console.log("redeem epoch:",epoch,"type:",type);
		
			//get the addresses of the dsec and principal tokens of S, AA, or A
			let addressPrincipal=contractsSaffronV1PrincipalTokens[epoch][type].options.address;
			let addressDsec=contractsSaffronV1DsecTokens[epoch][type].options.address;
		
			//remove liquidity from SaffronPool
	        swal({
	            title: "Redeeming "+title,
	            html: "<h5><i class='fa fa-spin fa-refresh'></i> Redeeming from the pool, please wait</h5><br>",
	            showConfirmButton: false,
	            imageUrl: "assets/images/saffron.png",
	            imageWidth: "48px"
	        });

			console.log("addressDsec:",addressDsec,"amountDsec:",amountDsec,"addressPrincipal:",addressPrincipal,"amountPrincipal:",amountPrincipal);
		
			//remove liquidity
			let failure=false;
			await contractSaffronPool.methods.remove_liquidity(addressDsec,amountDsec,addressPrincipal,amountPrincipal).send({
				from:currentAccount
// 			    gasLimit:web3.utils.toHex(300000),     // posted at compound.finance/developers#gas-costs
// 			    gasPrice:web3.utils.toHex(20000000000) // use ethgasstation.info (mainnet only)
			}).catch((e)=>{
				swal.close();
				console.log(`Error contractSaffronPool remove_liquidity: ${e.message}`);
				saffronAlert(e.message.split(":")[0],"Remove Liquidity Error");
				failure=true;
			});
			if(failure) {
				disableModalRedeemButtons(false);
				//restart slider update timer and exit
				timerModalPoolSlider=setTimeout(updateDepositDAIModal,60000);
				return;
			}
			swal.close();
		
			//get new balances
			await updateBalances();
			disableModalRedeemButtons(false);
			
			console.log("Redeemed was successful!");
	        swal({
	            title: 'Successful Redemption',
	            html: "<h5><i class='fa fa-spin fa-refresh'></i> Your redemption was successful!</h5><br>",
	            imageUrl: "assets/images/saffron.png",
	            timer: 3000,
	            imageWidth: "48px"
	        });
	        
			//hide modal
			$("#modalRedeemDai").modal("hide");
		} else {
			saffronAlert("Still in epoch 0!","Invalid Epoch");
		}
	}
	
	window.onload=init;

	</script>
	<!-- End js -->
</body>

</html>
